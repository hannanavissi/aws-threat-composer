(self.webpackChunk_aws_threat_composer=self.webpackChunk_aws_threat_composer||[]).push([[5902],{"./src/containers/ThreatModel/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var react=__webpack_require__("../../node_modules/react/index.js"),box=__webpack_require__("../../node_modules/@cloudscape-design/components/box/index.js"),components_button=__webpack_require__("../../node_modules/@cloudscape-design/components/button/index.js"),header=__webpack_require__("../../node_modules/@cloudscape-design/components/header/index.js"),popover=__webpack_require__("../../node_modules/@cloudscape-design/components/popover/index.js"),space_between=__webpack_require__("../../node_modules/@cloudscape-design/components/space-between/index.js"),spinner=__webpack_require__("../../node_modules/@cloudscape-design/components/spinner/index.js"),status_indicator=__webpack_require__("../../node_modules/@cloudscape-design/components/status-indicator/index.js"),design_tokens=__webpack_require__("../../node_modules/@cloudscape-design/design-tokens/index.js"),emotion_react_browser_esm=__webpack_require__("../../node_modules/@emotion/react/dist/emotion-react.browser.esm.js");const print={print:(0,emotion_react_browser_esm.iv)({"@media print":{color:`${design_tokens.I3K} !important`}}),hiddenPrint:(0,emotion_react_browser_esm.iv)({"@media print":{display:"none !important;"}})},downloadObjectAsMarkdown=(content,exportName)=>{var dataStr="data:text/markdown;charset=utf-8,"+encodeURIComponent(content),downloadAnchorNode=document.createElement("a");downloadAnchorNode.setAttribute("href",dataStr),downloadAnchorNode.setAttribute("download",exportName+".md"),document.body.appendChild(downloadAnchorNode),downloadAnchorNode.click(),downloadAnchorNode.remove()};var sanitizeHtml=__webpack_require__("./src/utils/sanitizeHtml/index.ts"),MarkdownViewer=__webpack_require__("./src/components/generic/MarkdownViewer/index.tsx");const getApplicationInfoContent=async data=>{const rows=[];return rows.push("## Application Info"),data.applicationInfo?.description&&rows.push(data.applicationInfo.description),rows.push("\n"),rows.join("\n")};try{getApplicationInfoContent.displayName="getApplicationInfoContent",getApplicationInfoContent.__docgenInfo={description:"",displayName:"getApplicationInfoContent",props:{schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"number"}},workspace:{defaultValue:null,description:"",name:"workspace",required:!1,type:{name:"{ name: string; id: string; }"}},applicationInfo:{defaultValue:null,description:"",name:"applicationInfo",required:!1,type:{name:"{ name?: string; description?: string; } | undefined"}},architecture:{defaultValue:null,description:"",name:"architecture",required:!1,type:{name:"{ description?: string; image?: string; } | undefined"}},dataflow:{defaultValue:null,description:"",name:"dataflow",required:!1,type:{name:"{ description?: string; image?: string; } | undefined"}},assumptions:{defaultValue:null,description:"",name:"assumptions",required:!1,type:{name:"{ id: string; numericId: number; content: string; tags?: string[]; displayOrder?: number; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; valid?: boolean | undefined; }[] | undefined"}},mitigations:{defaultValue:null,description:"",name:"mitigations",required:!1,type:{name:"{ id: string; numericId: number; content: string; tags?: string[]; displayOrder?: number; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; }[] | undefined"}},assumptionLinks:{defaultValue:null,description:"",name:"assumptionLinks",required:!1,type:{name:'{ type: "Mitigation" | "Threat"; assumptionId: string; linkedId: string; }[]'}},mitigationLinks:{defaultValue:null,description:"",name:"mitigationLinks",required:!1,type:{name:"{ linkedId: string; mitigationId: string; }[]"}},threats:{defaultValue:null,description:"",name:"threats",required:!1,type:{name:"{ id: string; numericId: number; tags?: string[]; displayOrder?: number; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }[] | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/report/ThreatModel/utils/getApplicationInfo/index.tsx#getApplicationInfoContent"]={docgenInfo:getApplicationInfoContent.__docgenInfo,name:"getApplicationInfoContent",path:"src/components/report/ThreatModel/utils/getApplicationInfo/index.tsx#getApplicationInfoContent"})}catch(__react_docgen_typescript_loader_error){}const replacements=[[/\*/g,"\\*","asterisks"],[/#/g,"\\#","number signs"],[/\//g,"\\/","slashes"],[/\(/g,"\\(","parentheses"],[/\)/g,"\\)","parentheses"],[/\[/g,"\\[","square brackets"],[/\]/g,"\\]","square brackets"],[/</g,"&lt;","angle brackets"],[/>/g,"&gt;","angle brackets"],[/_/g,"\\_","underscores"],[/`/g,"\\`","codeblocks"]],utils_escapeMarkdown=(input,skips=[])=>replacements.reduce(((str,replacement)=>{var name=replacement[2];return-1!==skips.indexOf(name)?str:str.replace(replacement[0],replacement[1])}),input),getApplicationName=async data=>data.applicationInfo?.name?`# ${utils_escapeMarkdown(data.applicationInfo?.name)}`:"";try{getApplicationName.displayName="getApplicationName",getApplicationName.__docgenInfo={description:"",displayName:"getApplicationName",props:{schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"number"}},workspace:{defaultValue:null,description:"",name:"workspace",required:!1,type:{name:"{ name: string; id: string; }"}},applicationInfo:{defaultValue:null,description:"",name:"applicationInfo",required:!1,type:{name:"{ name?: string; description?: string; } | undefined"}},architecture:{defaultValue:null,description:"",name:"architecture",required:!1,type:{name:"{ description?: string; image?: string; } | undefined"}},dataflow:{defaultValue:null,description:"",name:"dataflow",required:!1,type:{name:"{ description?: string; image?: string; } | undefined"}},assumptions:{defaultValue:null,description:"",name:"assumptions",required:!1,type:{name:"{ id: string; numericId: number; content: string; tags?: string[]; displayOrder?: number; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; valid?: boolean | undefined; }[] | undefined"}},mitigations:{defaultValue:null,description:"",name:"mitigations",required:!1,type:{name:"{ id: string; numericId: number; content: string; tags?: string[]; displayOrder?: number; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; }[] | undefined"}},assumptionLinks:{defaultValue:null,description:"",name:"assumptionLinks",required:!1,type:{name:'{ type: "Mitigation" | "Threat"; assumptionId: string; linkedId: string; }[]'}},mitigationLinks:{defaultValue:null,description:"",name:"mitigationLinks",required:!1,type:{name:"{ linkedId: string; mitigationId: string; }[]"}},threats:{defaultValue:null,description:"",name:"threats",required:!1,type:{name:"{ id: string; numericId: number; tags?: string[]; displayOrder?: number; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }[] | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/report/ThreatModel/utils/getApplicationName/index.tsx#getApplicationName"]={docgenInfo:getApplicationName.__docgenInfo,name:"getApplicationName",path:"src/components/report/ThreatModel/utils/getApplicationName/index.tsx#getApplicationName"})}catch(__react_docgen_typescript_loader_error){}const getArchitectureContent=async data=>{const rows=[];return rows.push("## Architecture"),data.architecture&&(data.architecture.description&&(rows.push("### Introduction"),rows.push(data.architecture.description)),data.architecture.image&&(rows.push("### Architecture Diagram"),rows.push(`![Architecture Diagram](${data.architecture.image})`))),rows.push("\n"),rows.join("\n")},utils_standardizeNumericId=numericId=>String(numericId).padStart(4,"0"),getAssetsContent=async data=>{const rows=[];if(rows.push("## Impacted Assets"),rows.push("\n"),rows.push("| Assets Number | Asset | Related Threats |"),rows.push("| --- | --- | --- |"),data.threats){const assetThreatMap={};data.threats.forEach((t=>t.impactedAssets?.forEach((ia=>{assetThreatMap[ia]||(assetThreatMap[ia]=[]),assetThreatMap[ia].push(t)}))));const promises=Object.keys(assetThreatMap).map((async(at,index)=>{const atId=`AS-${utils_standardizeNumericId(index+1)}`,threatsContent=assetThreatMap[at].map((t=>{const threatId=`T-${utils_standardizeNumericId(t.numericId)}`;return`[**${threatId}**](#${threatId}): ${utils_escapeMarkdown(t.statement||"")}`})).join("<br/>");return`| ${atId} | ${utils_escapeMarkdown(at)} | ${threatsContent} |`}));rows.push(...await Promise.all(promises))}return rows.push("\n"),rows.join("\n")};var lib=__webpack_require__("../../node_modules/rehype-stringify/lib/index.js"),remark_gfm=__webpack_require__("../../node_modules/remark-gfm/index.js"),remark_parse_lib=__webpack_require__("../../node_modules/remark-parse/lib/index.js"),remark_rehype_lib=__webpack_require__("../../node_modules/remark-rehype/lib/index.js"),unified_lib=__webpack_require__("../../node_modules/unified/lib/index.js");const utils_parseTableCellContent=async str=>{if(str){const htmlOutput=await(0,unified_lib.l)().use(remark_parse_lib.Z).use(remark_gfm.Z).use(remark_rehype_lib.Z).use(lib.Z).process(str);return String(htmlOutput).replace(/(\r\n|\n|\r)/gm,"")}return str},getAssumptionsContent=async data=>{const rows=[];if(rows.push("## Assumptions"),rows.push("\n"),rows.push("| Assumption Number | Assumption | Linked Threats | Linked Mitigations | Comments |"),rows.push("| --- | --- | --- | --- | --- |"),data.assumptions){const promises=data.assumptions?.map((async x=>{const threatLinks=data.assumptionLinks?.filter((al=>al.assumptionId===x.id&&"Threat"===al.type))||[],mitigationLinks=data.assumptionLinks?.filter((al=>al.assumptionId===x.id&&"Mitigation"===al.type))||[],threatsContent=threatLinks.map((tl=>{const threat=data.threats?.find((s=>s.id===tl.linkedId));if(threat){const threatId=`T-${utils_standardizeNumericId(threat.numericId)}`;return`[**${threatId}**](#${threatId}): ${utils_escapeMarkdown(threat.statement||"")}`}return null})).filter((t=>!!t)).join("<br/>"),mitigationsContent=mitigationLinks.map((tl=>{const mitigation=data.mitigations?.find((m=>m.id===tl.linkedId));if(mitigation){const mitigationId=`M-${utils_standardizeNumericId(mitigation.numericId)}`;return`[**${mitigationId}**](#${mitigationId}): ${utils_escapeMarkdown(mitigation.content)}`}return null})).filter((t=>!!t)).join("<br/>"),assumptionId=`A-${utils_standardizeNumericId(x.numericId)}`,comments=await utils_parseTableCellContent(x.metadata?.find((m=>"Comments"===m.key))?.value||"");return`| <a name="${assumptionId}"></a>${assumptionId} | ${utils_escapeMarkdown(x.content)} | ${threatsContent} | ${mitigationsContent} | ${comments} |`}));rows.push(...await Promise.all(promises))}return rows.push("\n"),rows.join("\n")},getDataflowContent=async data=>{const rows=[];return rows.push("## Dataflow"),data.dataflow&&(data.dataflow.description&&(rows.push("### Introduction"),rows.push(data.dataflow.description)),data.dataflow.image&&(rows.push("### Dataflow Diagram"),rows.push(`![Dataflow Diagram](${data.dataflow.image})`))),rows.push("\n"),rows.join("\n")},getMitigationsContent=async data=>{const rows=[];if(rows.push("## Mitigations"),rows.push("\n"),rows.push("| Mitigation Number | Mitigation | Threats Mitigating | Assumptions | Comments |"),rows.push("| --- | --- | --- | --- | --- |"),data.mitigations){const promises=data.mitigations.map((async x=>{const threats=data.mitigationLinks?.filter((ml=>ml.mitigationId===x.id))||[],assumpptionLinks=data.assumptionLinks?.filter((al=>al.linkedId===x.id))||[],threatsContent=threats.map((tl=>{const threat=data.threats?.find((s=>s.id===tl.linkedId));if(threat){const threatId=`T-${utils_standardizeNumericId(threat.numericId)}`;return`[**${threatId}**](#${threatId}): ${utils_escapeMarkdown(threat.statement||"")}`}return null})).filter((t=>!!t)).join("<br/>"),assumptionsContent=assumpptionLinks.map((al=>{const assumption=data.assumptions?.find((a=>a.id===al.assumptionId));if(assumption){const assumptionId=`A-${utils_standardizeNumericId(assumption.numericId)}`;return`[**${assumptionId}**](#${assumptionId}): ${utils_escapeMarkdown(assumption.content)}`}return null})).filter((a=>!!a)).join("<br/>"),comments=await utils_parseTableCellContent(x.metadata?.find((m=>"Comments"===m.key))?.value||""),mitigationId=`M-${utils_standardizeNumericId(x.numericId)}`;return`| <a name="${mitigationId}"></a>${mitigationId} | ${utils_escapeMarkdown(x.content)} | ${threatsContent} | ${assumptionsContent} | ${comments} |`}));rows.push(...await Promise.all(promises))}return rows.push("\n"),rows.join("\n")},getThreatsContent=async(data,threatsOnly=!1)=>{const rows=[];if(rows.push("## Threats"),rows.push("\n"),rows.push(`| Threat Number | Threat | ${threatsOnly?"":"Mitigations | Assumptions |"} Priority | STRIDE | Comments |`),rows.push(`| --- | --- | ${threatsOnly?"":"--- | --- |"} --- | --- | --- |`),data.threats){const promises=data.threats.map((async x=>{const mitigationLinks=data.mitigationLinks?.filter((ml=>ml.linkedId===x.id))||[],assumpptionLinks=data.assumptionLinks?.filter((al=>al.linkedId===x.id))||[],threatId=`T-${utils_standardizeNumericId(x.numericId)}`,assumptionsContent=assumpptionLinks.map((al=>{const assumption=data.assumptions?.find((a=>a.id===al.assumptionId));if(assumption){const assumptionId=`A-${utils_standardizeNumericId(assumption.numericId)}`;return`[**${assumptionId}**](#${assumptionId}): ${utils_escapeMarkdown(assumption.content)}`}return null})).filter((al=>!!al)).join("<br/>"),mitigationsContent=mitigationLinks.map((ml=>{const mitigation=data.mitigations?.find((m=>m.id===ml.mitigationId));if(mitigation){const mitigationId=`M-${utils_standardizeNumericId(mitigation.numericId)}`;return`[**${mitigationId}**](#${mitigationId}): ${utils_escapeMarkdown(mitigation.content)}`}return null})).filter((ml=>!!ml)).join("<br/>"),priority=x.metadata?.find((m=>"Priority"===m.key))?.value||"",STRIDE=(x.metadata?.find((m=>"STRIDE"===m.key))?.value||[]).join(", "),comments=await utils_parseTableCellContent(x.metadata?.find((m=>"Comments"===m.key))?.value||"");return`| <a name="${threatId}"></a>${threatId} | ${utils_escapeMarkdown(x.statement||"")} | ${threatsOnly?"":`${mitigationsContent} | ${assumptionsContent} | `} ${priority} | ${STRIDE} | ${comments} |`}));rows.push(...await Promise.all(promises))}return rows.push("\n"),rows.join("\n")};var emotion_react_jsx_runtime_browser_esm=__webpack_require__("../../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const ThreatModelView_styles={text:(0,emotion_react_browser_esm.iv)({display:"flex",alignItems:"center",height:"100%"}),nextStepsContainer:(0,emotion_react_browser_esm.iv)({borderTop:`2px solid ${design_tokens.UkX}`,paddingTop:design_tokens._Kl}),noData:(0,emotion_react_browser_esm.iv)({textAlign:"center",width:"100%"})},ThreatModelView=({data,isPreview=!1,composerMode,downloadFileName,onPrintButtonClick,hasContentDetails,...props})=>{const[content,setContent]=(0,react.useState)(""),[loading,setLoading]=(0,react.useState)(!0);(0,react.useEffect)((()=>{(async()=>{setLoading(!0);const sanitizedData=(0,sanitizeHtml.Z)(data),processedContent=("Full"===composerMode?[(!hasContentDetails||hasContentDetails.applicationName)&&await getApplicationName(sanitizedData),(!hasContentDetails||hasContentDetails.applicationInfo)&&await getApplicationInfoContent(sanitizedData),(!hasContentDetails||hasContentDetails.architecture)&&await getArchitectureContent(sanitizedData),(!hasContentDetails||hasContentDetails.dataflow)&&await getDataflowContent(sanitizedData),(!hasContentDetails||hasContentDetails.assumptions)&&await getAssumptionsContent(sanitizedData),(!hasContentDetails||hasContentDetails.threats)&&await getThreatsContent(sanitizedData),(!hasContentDetails||hasContentDetails.mitigations)&&await getMitigationsContent(sanitizedData),(!hasContentDetails||hasContentDetails.threats)&&await getAssetsContent(sanitizedData)]:[await getThreatsContent(sanitizedData,!0)]).filter((x=>!!x)).join("\n");setContent(processedContent),setLoading(!1)})().catch((err=>console.log("Error",err)))}),[data,composerMode,hasContentDetails]);const handleCopyMarkdown=(0,react.useCallback)((async()=>{await navigator.clipboard.writeText(content)}),[content]),handleDownloadMarkdown=(0,react.useCallback)((()=>{downloadFileName&&downloadObjectAsMarkdown(content,downloadFileName)}),[content,downloadFileName]),getNextStepButtons=(0,react.useCallback)((()=>{const buttons=[];hasContentDetails?.applicationInfo||buttons.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:props.onApplicationInfoView,children:"Add Application Info"})),hasContentDetails?.architecture||buttons.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:props.onArchitectureView,children:"Add Architecture"})),hasContentDetails?.dataflow||buttons.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:props.onDataflowView,children:"Add Dataflow"})),hasContentDetails?.assumptions||buttons.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:props.onAssumptionListView,children:"Add Assumptions"})),hasContentDetails?.threats||buttons.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:()=>props.onThreatListView?.(),children:"Add Threats"})),hasContentDetails?.threats||buttons.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:props.onMitigationListView,children:"Add Mitigations"}));const len=buttons.length;return buttons.flatMap(((b,index)=>index===len-1?(0,emotion_react_jsx_runtime_browser_esm.tZ)(box.Z,{children:b}):[b,(0,emotion_react_jsx_runtime_browser_esm.tZ)(box.Z,{fontWeight:"bold",css:ThreatModelView_styles.text,children:"or"})]))}),[hasContentDetails,props]);return(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{children:(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"vertical",size:"s",children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:print.hiddenPrint,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(header.Z,{actions:(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"horizontal",size:"xs",children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)(popover.Z,{dismissButton:!1,position:"top",size:"small",triggerType:"custom",content:(0,emotion_react_jsx_runtime_browser_esm.tZ)(status_indicator.Z,{type:"success",children:"Content copied"}),children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:handleCopyMarkdown,children:"Copy as Markdown"})}),downloadFileName&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:handleDownloadMarkdown,children:"Download as Markdown File"}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"primary",onClick:onPrintButtonClick||(()=>window.print()),children:"Print"})]})})}),content?(0,emotion_react_jsx_runtime_browser_esm.tZ)(MarkdownViewer.Z,{allowHtml:!0,children:content}):(0,emotion_react_jsx_runtime_browser_esm.tZ)(box.Z,{fontSize:"body-m",margin:"xxl",fontWeight:"bold",css:ThreatModelView_styles.noData,children:loading?(0,emotion_react_jsx_runtime_browser_esm.tZ)(spinner.Z,{}):"No data available"}),!isPreview&&"Full"===composerMode&&hasContentDetails&&Object.values(hasContentDetails).some((x=>!x))&&(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:print.hiddenPrint,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(box.Z,{css:ThreatModelView_styles.nextStepsContainer,children:(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"horizontal",size:"xs",children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)(box.Z,{fontWeight:"bold",css:ThreatModelView_styles.text,children:"Suggested next steps: "}),getNextStepButtons()]})})})]})})};ThreatModelView.displayName="ThreatModelView";const components_ThreatModelView=ThreatModelView;try{ThreatModelView.displayName="ThreatModelView",ThreatModelView.__docgenInfo={description:"",displayName:"ThreatModelView",props:{isPreview:{defaultValue:{value:"false"},description:"",name:"isPreview",required:!1,type:{name:"boolean"}},composerMode:{defaultValue:null,description:"",name:"composerMode",required:!0,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"{ schema: number; workspace?: { name: string; id: string; } | undefined; applicationInfo?: { name?: string | undefined; description?: string | undefined; } | undefined; architecture?: { description?: string | undefined; image?: string | undefined; } | undefined; ... 5 more ...; threats?: { ...; }[] | undefined; }"}},downloadFileName:{defaultValue:null,description:"",name:"downloadFileName",required:!1,type:{name:"string"}},onPrintButtonClick:{defaultValue:null,description:"",name:"onPrintButtonClick",required:!1,type:{name:"(() => void)"}},hasContentDetails:{defaultValue:null,description:"",name:"hasContentDetails",required:!1,type:{name:"HasContentDetails"}},onApplicationInfoView:{defaultValue:null,description:"",name:"onApplicationInfoView",required:!1,type:{name:"(() => void)"}},onArchitectureView:{defaultValue:null,description:"",name:"onArchitectureView",required:!1,type:{name:"(() => void)"}},onDataflowView:{defaultValue:null,description:"",name:"onDataflowView",required:!1,type:{name:"(() => void)"}},onAssumptionListView:{defaultValue:null,description:"",name:"onAssumptionListView",required:!1,type:{name:"(() => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"(() => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/report/ThreatModel/components/ThreatModelView/index.tsx#ThreatModelView"]={docgenInfo:ThreatModelView.__docgenInfo,name:"ThreatModelView",path:"src/components/report/ThreatModel/components/ThreatModelView/index.tsx#ThreatModelView"})}catch(__react_docgen_typescript_loader_error){}var contexts=__webpack_require__("./src/contexts/index.ts"),useExportImport=__webpack_require__("./src/hooks/useExportImport/index.ts"),useHasContent=__webpack_require__("./src/hooks/useHasContent/index.tsx"),getExportFileName=__webpack_require__("./src/utils/getExportFileName/index.ts"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const ThreatModel=({onPrintButtonClick,...props})=>{const{getWorkspaceData}=(0,useExportImport.Z)(),{composerMode}=(0,contexts.nk)(),[_,hasContentDetails]=(0,useHasContent.Z)(),{currentWorkspace}=(0,contexts.$C)(),downloadFileName=(0,react.useMemo)((()=>(0,getExportFileName.Z)(composerMode,!1,currentWorkspace)),[composerMode,currentWorkspace]),{onApplicationInfoView,onArchitectureView,onDataflowView,onAssumptionListView,onThreatListView,onMitigationListView}=(0,contexts.$C)();return(0,jsx_runtime.jsx)(components_ThreatModelView,{...props,onPrintButtonClick,composerMode,data:getWorkspaceData(),downloadFileName,hasContentDetails,onApplicationInfoView,onArchitectureView,onDataflowView,onAssumptionListView,onThreatListView,onMitigationListView})};ThreatModel.displayName="ThreatModel";const report_ThreatModel=ThreatModel;try{ThreatModel.displayName="ThreatModel",ThreatModel.__docgenInfo={description:"",displayName:"ThreatModel",props:{onPrintButtonClick:{defaultValue:null,description:"",name:"onPrintButtonClick",required:!1,type:{name:"(() => void)"}},isPreview:{defaultValue:null,description:"",name:"isPreview",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/report/ThreatModel/index.tsx#ThreatModel"]={docgenInfo:ThreatModel.__docgenInfo,name:"ThreatModel",path:"src/components/report/ThreatModel/index.tsx#ThreatModel"})}catch(__react_docgen_typescript_loader_error){}var WorkspaceContextAggregator=__webpack_require__("./src/contexts/WorkspaceContextAggregator/index.tsx");const ThreatModel_ThreatModel=({workspaceId})=>(0,jsx_runtime.jsx)(WorkspaceContextAggregator.Z,{requiredGlobalSetupContext:!0,workspaceId:workspaceId||null,composerMode:"Full",children:(0,jsx_runtime.jsx)(report_ThreatModel,{})});ThreatModel_ThreatModel.displayName="ThreatModel";const containers_ThreatModel=ThreatModel_ThreatModel;try{ThreatModel_ThreatModel.displayName="ThreatModel",ThreatModel_ThreatModel.__docgenInfo={description:"",displayName:"ThreatModel",props:{workspaceId:{defaultValue:null,description:"",name:"workspaceId",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/containers/ThreatModel/index.tsx#ThreatModel"]={docgenInfo:ThreatModel_ThreatModel.__docgenInfo,name:"ThreatModel",path:"src/containers/ThreatModel/index.tsx#ThreatModel"})}catch(__react_docgen_typescript_loader_error){}const index_stories={title:"fullMode/ThreatModelView",component:containers_ThreatModel},Default={};Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{}",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"./src/components/generic/MarkdownViewer/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components_icon__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@cloudscape-design/components/icon/index.js"),_cloudscape_design_components_text_content__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/@cloudscape-design/components/text-content/index.js"),_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/@cloudscape-design/design-tokens/index.js"),_emotion_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),react_markdown__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/react-markdown/lib/react-markdown.js"),rehype_raw__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/rehype-raw/index.js"),remark_frontmatter__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/remark-frontmatter/index.js"),remark_gfm__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/remark-gfm/index.js"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const externalPattern=/^((https?):\/\/)/,styles=(0,_emotion_react__WEBPACK_IMPORTED_MODULE_0__.iv)({"@media print":{color:"black !important"},"& img":{maxWidth:"1024px",width:"100%"},"& h1":{marginTop:`${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__._Kl} !important`,marginBottom:`${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__._Kl} !important`},"& h2":{marginTop:`${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__.OU} !important`,marginBottom:`${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__._Kl} !important`},"& h3":{marginTop:`${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__._Kl} !important`,marginBottom:`${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__._Kl} !important`},"& h4":{marginTop:`${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__._Kl} !important`,marginBottom:`${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__._Kl} !important`},"& table":{borderCollapse:"collapse"},"& tr":{borderTop:`1px solid ${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__.ZTU}`},"& th":{padding:"6px 13px",border:`1px solid ${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__.ZTU}`},"& td":{padding:"6px 13px",border:`1px solid ${_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__.ZTU}`},"table tr:nth-of-type(2n)":{background:_cloudscape_design_design_tokens__WEBPACK_IMPORTED_MODULE_1__.TNs}}),components={a:props=>{if(props.href){return externalPattern.test(props.href)?(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.BX)("a",{href:props.href,target:"_blank",rel:"noreferrer noopener",children:[props.children," ",(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.tZ)(_cloudscape_design_components_icon__WEBPACK_IMPORTED_MODULE_3__.Z,{name:"external"})]}):(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.tZ)("a",{href:props.href,children:props.children})}return props.name?(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.tZ)("a",{name:props.name,children:props.children}):(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.tZ)(_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.HY,{children:props.children})}},MarkdownViewer=({allowHtml=!1,children,...props})=>(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.tZ)("div",{css:styles,children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.tZ)(_cloudscape_design_components_text_content__WEBPACK_IMPORTED_MODULE_4__.Z,{...props,children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.tZ)(react_markdown__WEBPACK_IMPORTED_MODULE_5__.D,{remarkPlugins:[remark_gfm__WEBPACK_IMPORTED_MODULE_6__.Z,remark_frontmatter__WEBPACK_IMPORTED_MODULE_7__.Z],rehypePlugins:allowHtml?[rehype_raw__WEBPACK_IMPORTED_MODULE_8__.Z]:[],components,children})})});MarkdownViewer.displayName="MarkdownViewer";const __WEBPACK_DEFAULT_EXPORT__=MarkdownViewer;try{MarkdownViewer.displayName="MarkdownViewer",MarkdownViewer.__docgenInfo={description:"MarkdownViewer renders content with Markdown format.",displayName:"MarkdownViewer",props:{allowHtml:{defaultValue:{value:"false"},description:"",name:"allowHtml",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/MarkdownViewer/index.tsx#MarkdownViewer"]={docgenInfo:MarkdownViewer.__docgenInfo,name:"MarkdownViewer",path:"src/components/generic/MarkdownViewer/index.tsx#MarkdownViewer"})}catch(__react_docgen_typescript_loader_error){}},"./src/contexts/ContextAggregator/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _GlobalSetupContext__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/contexts/GlobalSetupContext/index.tsx"),_WorkspaceContextAggregator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/contexts/WorkspaceContextAggregator/index.tsx"),_WorkspacesContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/contexts/WorkspacesContext/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const ContextAggregator=({children,onWorkspaceChanged,composerMode="Full",features,onPreview,onPreviewClose,onImported,onDefineWorkload,...props})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_GlobalSetupContext__WEBPACK_IMPORTED_MODULE_0__.Z,{onPreview,onPreviewClose,onImported,features,onDefineWorkload,composerMode,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_WorkspacesContext__WEBPACK_IMPORTED_MODULE_2__.Z,{onWorkspaceChanged,...props,children:workspaceId=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_WorkspaceContextAggregator__WEBPACK_IMPORTED_MODULE_1__.Z,{workspaceId,requiredGlobalSetupContext:!1,onThreatEditorView:props.onThreatEditorView,onThreatListView:props.onThreatListView,children})})});ContextAggregator.displayName="ContextAggregator";const __WEBPACK_DEFAULT_EXPORT__=ContextAggregator;try{ContextAggregator.displayName="ContextAggregator",ContextAggregator.__docgenInfo={description:"",displayName:"ContextAggregator",props:{composerMode:{defaultValue:{value:"Full"},description:"",name:"composerMode",required:!1,type:{name:"enum",value:[{value:'"ThreatsOnly"'},{value:'"EditorOnly"'},{value:'"Full"'}]}},features:{defaultValue:null,description:"",name:"features",required:!1,type:{name:"string[]"}},onWorkspaceChanged:{defaultValue:null,description:"",name:"onWorkspaceChanged",required:!1,type:{name:"((workspaceId: string) => void)"}},onPreview:{defaultValue:null,description:"",name:"onPreview",required:!1,type:{name:"((content: { schema: number; workspace?: { name: string; id: string; }; applicationInfo?: { name?: string; description?: string | undefined; } | undefined; architecture?: { ...; } | undefined; ... 5 more ...; threats?: { ...; }[] | undefined; }) => void) | undefined"}},onPreviewClose:{defaultValue:null,description:"",name:"onPreviewClose",required:!1,type:{name:"(() => void)"}},onImported:{defaultValue:null,description:"",name:"onImported",required:!1,type:{name:"(() => void)"}},onDefineWorkload:{defaultValue:null,description:"",name:"onDefineWorkload",required:!1,type:{name:"(() => void)"}},onApplicationInfoView:{defaultValue:null,description:"",name:"onApplicationInfoView",required:!1,type:{name:"(() => void)"}},onArchitectureView:{defaultValue:null,description:"",name:"onArchitectureView",required:!1,type:{name:"(() => void)"}},onDataflowView:{defaultValue:null,description:"",name:"onDataflowView",required:!1,type:{name:"(() => void)"}},onAssumptionListView:{defaultValue:null,description:"",name:"onAssumptionListView",required:!1,type:{name:"(() => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"(() => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/contexts/ContextAggregator/index.tsx#ContextAggregator"]={docgenInfo:ContextAggregator.__docgenInfo,name:"ContextAggregator",path:"src/contexts/ContextAggregator/index.tsx#ContextAggregator"})}catch(__react_docgen_typescript_loader_error){}},"./src/contexts/WorkspacesContext/context.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$:()=>useWorkspacesContext,z:()=>WorkspacesContext});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js");const initialState={workspaceList:[],setWorkspaceList:()=>{},currentWorkspace:null,switchWorkspace:()=>{},addWorkspace:()=>{},removeWorkspace:()=>Promise.resolve(),renameWorkspace:()=>{}},WorkspacesContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(initialState),useWorkspacesContext=()=>(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(WorkspacesContext)},"./src/contexts/WorkspacesContext/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>contexts_WorkspacesContext,$:()=>context.$});var react=__webpack_require__("../../node_modules/react/index.js"),es=__webpack_require__("../../node_modules/use-local-storage-state/es/index.js"),v4=__webpack_require__("../../node_modules/uuid/dist/esm-browser/v4.js"),context=__webpack_require__("./src/contexts/WorkspacesContext/context.ts"),constants=__webpack_require__("./src/configs/constants.ts"),localStorageKeys=__webpack_require__("./src/configs/localStorageKeys.ts"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const WorkspacesMigration=({children})=>{const{workspaceList,setWorkspaceList}=(0,context.$)(),[migrated,setMigrated]=(0,es.Z)(localStorageKeys.bd,{defaultValue:!1});return(0,react.useEffect)((()=>{migrated||(workspaceList.length>0&&"string"==typeof workspaceList[0]&&setWorkspaceList((prev=>{const newList=prev.map((p=>({id:(0,v4.Z)(),name:p})));return currentWorkspace&&"string"==typeof currentWorkspace&&setCurrentWorkspace((prevWs=>newList.find((x=>x.name===prevWs)))),newList})),setMigrated(!0))}),[workspaceList,migrated]),migrated&&children?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children}):null},migrations_WorkspacesMigration=WorkspacesMigration;try{WorkspacesMigration.displayName="WorkspacesMigration",WorkspacesMigration.__docgenInfo={description:"Migrates the old workspaces list to the new format",displayName:"WorkspacesMigration",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/migrations/WorkspacesMigration/index.tsx#WorkspacesMigration"]={docgenInfo:WorkspacesMigration.__docgenInfo,name:"WorkspacesMigration",path:"src/migrations/WorkspacesMigration/index.tsx#WorkspacesMigration"})}catch(__react_docgen_typescript_loader_error){}const WorkspacesContextProvider=({children,workspaceId,onWorkspaceChanged,...props})=>{const[currentWorkspace,setCurrentWorkspace]=(0,es.Z)(localStorageKeys.fY,{defaultValue:null}),[workspaceList,setWorkspaceList]=(0,es.Z)(localStorageKeys.Zh,{defaultValue:[]});(0,react.useEffect)((()=>{if(workspaceId)if(workspaceId===constants.Ac&&null!==currentWorkspace)setCurrentWorkspace(null);else if(workspaceId!==currentWorkspace?.id){const foundWorkspace=workspaceList.find((x=>x.id===workspaceId));setCurrentWorkspace(foundWorkspace||null)}}),[workspaceId,workspaceList,currentWorkspace]);const handleSwitchWorkspace=(0,react.useCallback)((workspace=>{setCurrentWorkspace(workspace),onWorkspaceChanged?.(workspace?.id||constants.Ac)}),[onWorkspaceChanged]),handleAddWorkspace=(0,react.useCallback)((workspaceName=>{const newWorkspace={id:(0,v4.Z)(),name:workspaceName};setWorkspaceList((prev=>prev.find((p=>p.name===workspaceName))?[...prev]:[...prev,newWorkspace])),setCurrentWorkspace(newWorkspace),onWorkspaceChanged?.(newWorkspace.id)}),[onWorkspaceChanged]),handleRemoveWorkspace=(0,react.useCallback)((async id=>{setWorkspaceList((prev=>prev.filter((p=>p.id!==id))))}),[]),handleRenameWorkspace=(0,react.useCallback)(((id,newWorkspaceName)=>{setWorkspaceList((prev=>{const index=prev.findIndex((w=>w.id===id));return[...prev.slice(0,index-1),{id,name:newWorkspaceName},...prev.slice(index+1)]})),setCurrentWorkspace({id,name:newWorkspaceName})}),[]);return(0,jsx_runtime.jsx)(context.z.Provider,{value:{workspaceList,setWorkspaceList,currentWorkspace,switchWorkspace:handleSwitchWorkspace,addWorkspace:handleAddWorkspace,removeWorkspace:handleRemoveWorkspace,renameWorkspace:handleRenameWorkspace,...props},children:(0,jsx_runtime.jsx)(migrations_WorkspacesMigration,{children:children(currentWorkspace?.id||null)})})};WorkspacesContextProvider.displayName="WorkspacesContextProvider";const contexts_WorkspacesContext=WorkspacesContextProvider;try{WorkspacesContext.displayName="WorkspacesContext",WorkspacesContext.__docgenInfo={description:"",displayName:"WorkspacesContext",props:{workspaceId:{defaultValue:null,description:"",name:"workspaceId",required:!1,type:{name:"string"}},onWorkspaceChanged:{defaultValue:null,description:"",name:"onWorkspaceChanged",required:!1,type:{name:"((workspaceId: string) => void)"}},onApplicationInfoView:{defaultValue:null,description:"",name:"onApplicationInfoView",required:!1,type:{name:"(() => void)"}},onArchitectureView:{defaultValue:null,description:"",name:"onArchitectureView",required:!1,type:{name:"(() => void)"}},onDataflowView:{defaultValue:null,description:"",name:"onDataflowView",required:!1,type:{name:"(() => void)"}},onAssumptionListView:{defaultValue:null,description:"",name:"onAssumptionListView",required:!1,type:{name:"(() => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"(() => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/contexts/WorkspacesContext/index.tsx#WorkspacesContext"]={docgenInfo:WorkspacesContext.__docgenInfo,name:"WorkspacesContext",path:"src/contexts/WorkspacesContext/index.tsx#WorkspacesContext"})}catch(__react_docgen_typescript_loader_error){}},"./src/contexts/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$C:()=>_WorkspacesContext_context__WEBPACK_IMPORTED_MODULE_19__.$,Lf:()=>_ContextAggregator__WEBPACK_IMPORTED_MODULE_25__.Z,_m:()=>_AssumptionLinksContext_context__WEBPACK_IMPORTED_MODULE_5__._,eu:()=>_MitigationLinksContext_context__WEBPACK_IMPORTED_MODULE_13__.e,nk:()=>_GlobalSetupContext_context__WEBPACK_IMPORTED_MODULE_11__.n});__webpack_require__("./src/contexts/ApplicationContext/index.tsx"),__webpack_require__("./src/contexts/ApplicationContext/context.ts"),__webpack_require__("./src/contexts/ArchitectureContext/index.tsx"),__webpack_require__("./src/contexts/ArchitectureContext/context.ts"),__webpack_require__("./src/contexts/AssumptionLinksContext/index.tsx");var _AssumptionLinksContext_context__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/contexts/AssumptionLinksContext/context.ts"),_GlobalSetupContext_context__WEBPACK_IMPORTED_MODULE_11__=(__webpack_require__("./src/contexts/AssumptionsContext/index.tsx"),__webpack_require__("./src/contexts/AssumptionsContext/context.ts"),__webpack_require__("./src/contexts/DataflowContext/index.tsx"),__webpack_require__("./src/contexts/DataflowContext/context.ts"),__webpack_require__("./src/contexts/GlobalSetupContext/index.tsx"),__webpack_require__("./src/contexts/GlobalSetupContext/context.ts")),_MitigationLinksContext_context__WEBPACK_IMPORTED_MODULE_13__=(__webpack_require__("./src/contexts/MitigationLinksContext/index.tsx"),__webpack_require__("./src/contexts/MitigationLinksContext/context.ts")),_WorkspacesContext_context__WEBPACK_IMPORTED_MODULE_19__=(__webpack_require__("./src/contexts/MitigationsContext/index.tsx"),__webpack_require__("./src/contexts/MitigationsContext/context.ts"),__webpack_require__("./src/contexts/ThreatsContext/index.tsx"),__webpack_require__("./src/contexts/ThreatsContext/context.ts"),__webpack_require__("./src/contexts/WorkspacesContext/index.tsx"),__webpack_require__("./src/contexts/WorkspacesContext/context.ts")),_ContextAggregator__WEBPACK_IMPORTED_MODULE_25__=(__webpack_require__("./src/contexts/ThreatPacksContext/index.tsx"),__webpack_require__("./src/contexts/ThreatPacksContext/context.ts"),__webpack_require__("./src/contexts/MitigationPacksContext/index.tsx"),__webpack_require__("./src/contexts/MitigationPacksContext/context.ts"),__webpack_require__("./src/contexts/WorkspaceContextAggregator/index.tsx"),__webpack_require__("./src/contexts/ContextAggregator/index.tsx"))},"./src/hooks/useExportImport/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>useExportImport});var react=__webpack_require__("../../node_modules/react/index.js"),contexts=__webpack_require__("./src/contexts/index.ts"),context=__webpack_require__("./src/contexts/ApplicationContext/context.ts"),ArchitectureContext_context=__webpack_require__("./src/contexts/ArchitectureContext/context.ts"),AssumptionLinksContext_context=__webpack_require__("./src/contexts/AssumptionLinksContext/context.ts"),AssumptionsContext_context=__webpack_require__("./src/contexts/AssumptionsContext/context.ts"),DataflowContext_context=__webpack_require__("./src/contexts/DataflowContext/context.ts"),GlobalSetupContext_context=__webpack_require__("./src/contexts/GlobalSetupContext/context.ts"),MitigationLinksContext_context=__webpack_require__("./src/contexts/MitigationLinksContext/context.ts"),MitigationsContext_context=__webpack_require__("./src/contexts/MitigationsContext/context.ts"),ThreatsContext_context=__webpack_require__("./src/contexts/ThreatsContext/context.ts");const utils_cleanupThreatData=threats=>threats.map((t=>{const nt={...t};return delete nt.displayedStatement,nt})),utils_downloadObjectAsJson=(exportObj,exportName)=>{var dataStr="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(exportObj,null,2)),downloadAnchorNode=document.createElement("a");downloadAnchorNode.setAttribute("href",dataStr),downloadAnchorNode.setAttribute("download",exportName+".tc.json"),document.body.appendChild(downloadAnchorNode),downloadAnchorNode.click(),downloadAnchorNode.remove()};var getExportFileName=__webpack_require__("./src/utils/getExportFileName/index.ts"),renderThreatStatement=__webpack_require__("./src/utils/renderThreatStatement/index.ts");const utils_recalculateThreatData=threats=>threats.map((t=>{const{displayedStatement}=(0,renderThreatStatement.Z)(t);return{...t,displayedStatement}}));var sanitizeHtml=__webpack_require__("./src/utils/sanitizeHtml/index.ts"),customTypes=__webpack_require__("./src/customTypes/index.ts");const utils_validateData=data=>customTypes.DataExchangeFormatSchema.safeParse(data),useExportImport=()=>{const{composerMode}=(0,GlobalSetupContext_context.n)(),{currentWorkspace}=(0,contexts.$C)(),{applicationInfo,setApplicationInfo}=(0,context.M)(),{architectureInfo,setArchitectureInfo}=(0,ArchitectureContext_context.P)(),{dataflowInfo,setDataflowInfo}=(0,DataflowContext_context.y)(),{assumptionList,setAssumptionList}=(0,AssumptionsContext_context.H)(),{mitigationList,setMitigationList}=(0,MitigationsContext_context.I)(),{statementList,setStatementList}=(0,ThreatsContext_context.a)(),{assumptionLinkList,setAssumptionLinkList}=(0,AssumptionLinksContext_context._)(),{mitigationLinkList,setMitigationLinkList}=(0,MitigationLinksContext_context.e)(),getWorkspaceData=(0,react.useCallback)((()=>{const cleanedThreats=utils_cleanupThreatData(statementList);return"Full"===composerMode?{schema:1,applicationInfo,architecture:architectureInfo,dataflow:dataflowInfo,assumptions:assumptionList,mitigations:mitigationList,assumptionLinks:assumptionLinkList,mitigationLinks:mitigationLinkList,threats:cleanedThreats}:{schema:1,threats:cleanedThreats}}),[composerMode,currentWorkspace,applicationInfo,architectureInfo,dataflowInfo,assumptionList,mitigationList,assumptionLinkList,mitigationLinkList,statementList]),exportAll=(0,react.useCallback)((()=>{const exportFileName=(0,getExportFileName.Z)(composerMode,!1,currentWorkspace),exportObject=getWorkspaceData();utils_downloadObjectAsJson(exportObject,exportFileName)}),[getWorkspaceData,currentWorkspace,composerMode]),exportSelectedThreats=(0,react.useCallback)((selectedStatementList=>{const exportFileName=(0,getExportFileName.Z)(composerMode,!0,currentWorkspace);utils_downloadObjectAsJson({schema:1,workspace:currentWorkspace,threats:selectedStatementList},exportFileName)}),[currentWorkspace]),parseImportedData=(0,react.useCallback)((data=>{const parsedData=(0,sanitizeHtml.Z)(data);if(Array.isArray(parsedData))return{schema:-1,threats:data};const validatedData=utils_validateData(parsedData);if(!validatedData.success)throw new Error(validatedData.error.issues.map((i=>`${i.path}: ${i.message}`)).join("\n"));const importedData=validatedData.data;if(!parsedData.schema||1!==parsedData.schema)throw new Error("Unsupported Schema version");return importedData}),[]),importData=(0,react.useCallback)((data=>{const calculatedThreats=utils_recalculateThreatData(data.threats||[]);data.schema>0?(setApplicationInfo(data.applicationInfo||{}),setArchitectureInfo(data.architecture||{}),setDataflowInfo(data.dataflow||{}),setAssumptionList(data.assumptions||[]),setMitigationList(data.mitigations||[]),setStatementList(calculatedThreats),setAssumptionLinkList(data.assumptionLinks||[]),setMitigationLinkList(data.mitigationLinks||[])):setStatementList(data.threats||[])}),[setApplicationInfo,setArchitectureInfo,setDataflowInfo,setAssumptionList,setMitigationList,setStatementList,setAssumptionLinkList,setMitigationLinkList]);return{getWorkspaceData,exportAll,exportSelectedThreats,parseImportedData,importData}}},"./src/hooks/useHasContent/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>hooks_useHasContent});var react=__webpack_require__("../../node_modules/react/index.js"),ApplicationContext=__webpack_require__("./src/contexts/ApplicationContext/index.tsx"),ArchitectureContext=__webpack_require__("./src/contexts/ArchitectureContext/index.tsx"),AssumptionsContext=__webpack_require__("./src/contexts/AssumptionsContext/index.tsx"),DataflowContext=__webpack_require__("./src/contexts/DataflowContext/index.tsx"),MitigationsContext=__webpack_require__("./src/contexts/MitigationsContext/index.tsx"),ThreatsContext=__webpack_require__("./src/contexts/ThreatsContext/index.tsx");const hasApplicationName=applicationInfo=>!!applicationInfo.name,hasApplicationInfo=applicationInfo=>!!applicationInfo.description,hasDataflowInfo=dataflowInfo=>!(!dataflowInfo.description&&!dataflowInfo.image),hooks_useHasContent=()=>{const{applicationInfo}=(0,ApplicationContext.M)(),{architectureInfo}=(0,ArchitectureContext.P)(),{dataflowInfo}=(0,DataflowContext.y)(),{assumptionList}=(0,AssumptionsContext.H)(),{mitigationList}=(0,MitigationsContext.I)(),{statementList}=(0,ThreatsContext.a)();return(0,react.useMemo)((()=>{const details={applicationName:hasApplicationName(applicationInfo),applicationInfo:hasApplicationInfo(applicationInfo),architecture:(archInfo=architectureInfo,!(!archInfo.description&&!archInfo.image)),dataflow:hasDataflowInfo(dataflowInfo),assumptions:(assumptions=assumptionList,assumptions.length>0),mitigations:(mitigations=mitigationList,mitigations.length>0),threats:(threatStatementList=statementList,threatStatementList.length>0)};var threatStatementList,mitigations,assumptions,archInfo;return[Object.values(details).some((x=>x)),details]}),[applicationInfo,architectureInfo,dataflowInfo,assumptionList,mitigationList,statementList])}},"./src/utils/getExportFileName/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>utils_getExportFileName});const utils_getExportFileName=(composerMode,filtered,currentWorkspace)=>`ThreatComposer_Workspace_${currentWorkspace?currentWorkspace.name.replace(" ","-"):"Default"}${"Full"!==composerMode?"_ThreatsOnly":""}${filtered?"_Filtered":""}`},"./src/utils/sanitizeHtml/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var sanitize_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/sanitize-html/index.js"),sanitize_html__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(sanitize_html__WEBPACK_IMPORTED_MODULE_0__);const sanitizeHtml=data=>{if(data){if(Array.isArray(data))return data.map((d=>sanitizeHtml(d)));if("string"==typeof data)return sanitize_html__WEBPACK_IMPORTED_MODULE_0___default()(data,{allowedTags:[]});if("object"==typeof data)return Object.keys(data).reduce(((attrs,key)=>({...attrs,[key]:sanitizeHtml(data[key])})),{})}return data},__WEBPACK_DEFAULT_EXPORT__=sanitizeHtml},"?d84b":()=>{},"?e4b0":()=>{},"?7cbf":()=>{},"?df09":()=>{},"?67ab":()=>{}}]);