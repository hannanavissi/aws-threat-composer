"use strict";(self.webpackChunk_aws_threat_composer=self.webpackChunk_aws_threat_composer||[]).push([[1775],{"./src/components/assumptions/AssumptionLinkView/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components_autosuggest__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@cloudscape-design/components/autosuggest/index.js"),_cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@cloudscape-design/components/expandable-section/index.js"),_cloudscape_design_components_token_group__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/@cloudscape-design/components/token-group/index.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const AssumptionLinkComponent=({linkedAssumptionIds,assumptionList,onAddAssumptionLink,onRemoveAssumptionLink,variant})=>{const[searchValue,setSearchValue]=react__WEBPACK_IMPORTED_MODULE_0__.useState(""),linkedAssumptions=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>assumptionList.filter((al=>linkedAssumptionIds.includes(al.id)))),[linkedAssumptionIds,assumptionList]),filteredAssumptions=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>{const assumptions=assumptionList.filter((x=>!linkedAssumptionIds.includes(x.id)));return searchValue?assumptions.filter((x=>x.content.toLowerCase().indexOf(searchValue.toLowerCase())>=0)):assumptions}),[searchValue,assumptionList,linkedAssumptionIds]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_2__.Z,{variant,headingTagOverride:"container"===variant?"h3":void 0,headerText:`Linked assumptions (${linkedAssumptions.length})`,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_autosuggest__WEBPACK_IMPORTED_MODULE_3__.Z,{onChange:({detail})=>setSearchValue(detail.value),value:searchValue,options:filteredAssumptions.map((x=>({value:x.id,label:x.content}))),onSelect:({detail})=>{onAddAssumptionLink(detail.value),setSearchValue("")},filteringType:"manual",enteredTextLabel:value=>`Add new assumption: "${value}"`,placeholder:"Search assumption",empty:"No matches found"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_token_group__WEBPACK_IMPORTED_MODULE_4__.Z,{items:linkedAssumptions.map((x=>({label:x.content,dismissLabel:`Unlink assumption ${x.numericId}`}))),onDismiss:({detail:{itemIndex}})=>{onRemoveAssumptionLink(linkedAssumptions[itemIndex].id)}})]})};AssumptionLinkComponent.displayName="AssumptionLinkComponent";const __WEBPACK_DEFAULT_EXPORT__=AssumptionLinkComponent;try{AssumptionLinkView.displayName="AssumptionLinkView",AssumptionLinkView.__docgenInfo={description:"",displayName:"AssumptionLinkView",props:{variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"footer"'},{value:'"container"'},{value:'"stacked"'},{value:'"default"'},{value:'"navigation"'}]}},linkedAssumptionIds:{defaultValue:null,description:"",name:"linkedAssumptionIds",required:!0,type:{name:"string[]"}},assumptionList:{defaultValue:null,description:"",name:"assumptionList",required:!0,type:{name:"{ id: string; numericId: number; content: string; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; valid?: boolean | undefined; }[]"}},onAddAssumptionLink:{defaultValue:null,description:"",name:"onAddAssumptionLink",required:!0,type:{name:"(assumptionId: string) => void"}},onRemoveAssumptionLink:{defaultValue:null,description:"",name:"onRemoveAssumptionLink",required:!0,type:{name:"(assumptionId: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/assumptions/AssumptionLinkView/index.tsx#AssumptionLinkView"]={docgenInfo:AssumptionLinkView.__docgenInfo,name:"AssumptionLinkView",path:"src/components/assumptions/AssumptionLinkView/index.tsx#AssumptionLinkView"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/generic/STRIDESelector/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{J:()=>OPTIONS,Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components_form_field__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/@cloudscape-design/components/form-field/index.js"),_cloudscape_design_components_multiselect__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@cloudscape-design/components/multiselect/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const OPTIONS=[{label:"Spoofing",value:"S"},{label:"Tampering",value:"T"},{label:"Repudiation",value:"R"},{label:"Information disclosure",value:"I"},{label:"Denial of service",value:"D"},{label:"Elevation of privilege",value:"E"}],STRIDESelector=({label,selected,setSelected})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_cloudscape_design_components_form_field__WEBPACK_IMPORTED_MODULE_1__.Z,{label,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_cloudscape_design_components_multiselect__WEBPACK_IMPORTED_MODULE_2__.Z,{selectedOptions:selected?OPTIONS.filter((x=>selected.includes(x.value))):[],onChange:({detail})=>setSelected(detail.selectedOptions.map((x=>x.value||""))),options:OPTIONS,selectedAriaLabel:"Selected"})});STRIDESelector.displayName="STRIDESelector";const __WEBPACK_DEFAULT_EXPORT__=STRIDESelector;try{STRIDESelector.displayName="STRIDESelector",STRIDESelector.__docgenInfo={description:"",displayName:"STRIDESelector",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},selected:{defaultValue:null,description:"",name:"selected",required:!1,type:{name:"string[]"}},setSelected:{defaultValue:null,description:"",name:"setSelected",required:!0,type:{name:"(value: string[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/STRIDESelector/index.tsx#STRIDESelector"]={docgenInfo:STRIDESelector.__docgenInfo,name:"STRIDESelector",path:"src/components/generic/STRIDESelector/index.tsx#STRIDESelector"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/mitigations/MitigationLinkView/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components_autosuggest__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@cloudscape-design/components/autosuggest/index.js"),_cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@cloudscape-design/components/expandable-section/index.js"),_cloudscape_design_components_token_group__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/@cloudscape-design/components/token-group/index.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const MitigationLinkComponent=({variant,linkedMitigationIds,mitigationList,onAddMitigationLink,onRemoveMitigationLink})=>{const[searchValue,setSearchValue]=react__WEBPACK_IMPORTED_MODULE_0__.useState(""),linkedMitigations=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>mitigationList.filter((al=>linkedMitigationIds.includes(al.id)))),[linkedMitigationIds,mitigationList]),filteredMitigations=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>{const mitigations=mitigationList.filter((x=>!linkedMitigationIds.includes(x.id)));return searchValue?mitigations.filter((x=>x.content.toLowerCase().indexOf(searchValue.toLowerCase())>=0)):mitigations}),[searchValue,mitigationList,linkedMitigationIds]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_2__.Z,{variant,headingTagOverride:"container"===variant?"h3":void 0,headerText:`Linked mitigations (${linkedMitigations.length})`,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_autosuggest__WEBPACK_IMPORTED_MODULE_3__.Z,{onChange:({detail})=>setSearchValue(detail.value),value:searchValue,options:filteredMitigations.map((x=>({value:x.id,label:x.content}))),onSelect:({detail})=>{onAddMitigationLink(detail.value),setSearchValue("")},filteringType:"manual",enteredTextLabel:value=>`Add new mitigation: "${value}"`,placeholder:"Search mitigation",empty:"No matches found"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{style:{display:"flex"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_token_group__WEBPACK_IMPORTED_MODULE_4__.Z,{items:linkedMitigations.map((x=>({label:x.content,dismissLabel:`Unlink mitigation ${x.numericId}`}))),onDismiss:({detail:{itemIndex}})=>{onRemoveMitigationLink(linkedMitigations[itemIndex].id)}})})]})};MitigationLinkComponent.displayName="MitigationLinkComponent";const __WEBPACK_DEFAULT_EXPORT__=MitigationLinkComponent;try{MitigationLinkView.displayName="MitigationLinkView",MitigationLinkView.__docgenInfo={description:"",displayName:"MitigationLinkView",props:{variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"footer"'},{value:'"container"'},{value:'"stacked"'},{value:'"default"'},{value:'"navigation"'}]}},linkedMitigationIds:{defaultValue:null,description:"",name:"linkedMitigationIds",required:!0,type:{name:"string[]"}},mitigationList:{defaultValue:null,description:"",name:"mitigationList",required:!0,type:{name:"{ id: string; numericId: number; content: string; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; }[]"}},onAddMitigationLink:{defaultValue:null,description:"",name:"onAddMitigationLink",required:!0,type:{name:"(mitigationId: string) => void"}},onRemoveMitigationLink:{defaultValue:null,description:"",name:"onRemoveMitigationLink",required:!0,type:{name:"(mitigationId: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/mitigations/MitigationLinkView/index.tsx#MitigationLinkView"]={docgenInfo:MitigationLinkView.__docgenInfo,name:"MitigationLinkView",path:"src/components/mitigations/MitigationLinkView/index.tsx#MitigationLinkView"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/threats/MetadataEditor/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/@cloudscape-design/components/expandable-section/index.js"),_cloudscape_design_components_grid__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/@cloudscape-design/components/grid/index.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_styles_expandablePanelHeader__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/styles/expandablePanelHeader.ts"),_generic_CommentsEdit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/generic/CommentsEdit/index.tsx"),_generic_STRIDESelector__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/generic/STRIDESelector/index.tsx"),_PriorityEdit__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/threats/PriorityEdit/index.tsx"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const MetadataEditor=({variant,editingStatement,onEditMetadata})=>{const stride=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>editingStatement.metadata?.find((m=>"STRIDE"===m.key))?.value||void 0),[editingStatement.metadata]);return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.tZ)(_cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_6__.Z,{headerText:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.tZ)("span",{css:"default"===variant?_styles_expandablePanelHeader__WEBPACK_IMPORTED_MODULE_1__.Z:void 0,children:"Metadata"}),headingTagOverride:"h3",variant,children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.BX)(_cloudscape_design_components_grid__WEBPACK_IMPORTED_MODULE_7__.Z,{gridDefinition:[{colspan:{default:12,xs:3}},{colspan:{default:12,xs:9}},{colspan:{default:12,xs:12}}],children:[(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.tZ)(_PriorityEdit__WEBPACK_IMPORTED_MODULE_4__.Z,{editingStatement,onEditMetadata}),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.tZ)(_generic_STRIDESelector__WEBPACK_IMPORTED_MODULE_3__.Z,{label:"STRIDE",selected:stride,setSelected:selected=>onEditMetadata(editingStatement,"STRIDE",selected)}),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.tZ)(_generic_CommentsEdit__WEBPACK_IMPORTED_MODULE_2__.Z,{entity:editingStatement,onEditEntity:onEditMetadata})]})})};MetadataEditor.displayName="MetadataEditor";const __WEBPACK_DEFAULT_EXPORT__=MetadataEditor;try{MetadataEditor.displayName="MetadataEditor",MetadataEditor.__docgenInfo={description:"",displayName:"MetadataEditor",props:{variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"footer"'},{value:'"container"'},{value:'"stacked"'},{value:'"default"'},{value:'"navigation"'}]}},editingStatement:{defaultValue:null,description:"",name:"editingStatement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},onEditMetadata:{defaultValue:null,description:"",name:"onEditMetadata",required:!0,type:{name:"(statement: { id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }, key: string, value: string |..."}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/MetadataEditor/index.tsx#MetadataEditor"]={docgenInfo:MetadataEditor.__docgenInfo,name:"MetadataEditor",path:"src/components/threats/MetadataEditor/index.tsx#MetadataEditor"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/threats/PriorityEdit/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>threats_PriorityEdit});var react=__webpack_require__("../../node_modules/react/index.js"),form_field=__webpack_require__("../../node_modules/@cloudscape-design/components/form-field/index.js"),components_select=__webpack_require__("../../node_modules/@cloudscape-design/components/select/index.js"),configs=__webpack_require__("./src/configs/index.ts"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const LevelSelector=react.forwardRef((({label,selectedLevel,setSelectedLevel,allowNoValue,placeholder,onFocus,onBlur},ref)=>(0,jsx_runtime.jsx)(form_field.Z,{label,children:(0,jsx_runtime.jsx)(components_select.Z,{ref,selectedOption:configs.p4.find((x=>x.value===selectedLevel))||null,onChange:({detail})=>{const selected=detail.selectedOption.value;setSelectedLevel?.(selected&&"-"!==selected?selected:void 0)},options:allowNoValue?[{label:"-",value:"-"},...configs.p4]:configs.p4,selectedAriaLabel:"Selected",onFocus,onBlur,expandToViewport:!0,placeholder})}))),generic_LevelSelector=LevelSelector;try{LevelSelector.displayName="LevelSelector",LevelSelector.__docgenInfo={description:"",displayName:"LevelSelector",props:{label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"string"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},selectedLevel:{defaultValue:null,description:"",name:"selectedLevel",required:!1,type:{name:"string"}},setSelectedLevel:{defaultValue:null,description:"",name:"setSelectedLevel",required:!1,type:{name:"((level: string) => void)"}},allowNoValue:{defaultValue:null,description:"",name:"allowNoValue",required:!1,type:{name:"boolean"}},onFocus:{defaultValue:null,description:"",name:"onFocus",required:!1,type:{name:"(() => void)"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/LevelSelector/index.tsx#LevelSelector"]={docgenInfo:LevelSelector.__docgenInfo,name:"LevelSelector",path:"src/components/generic/LevelSelector/index.tsx#LevelSelector"})}catch(__react_docgen_typescript_loader_error){}const PriorityEdit=react.forwardRef((({editingStatement,onEditMetadata,showLabel=!0,...props},ref)=>{const priority=(0,react.useMemo)((()=>editingStatement.metadata?.find((m=>"Priority"===m.key))?.value||void 0),[editingStatement.metadata]);return(0,jsx_runtime.jsx)(generic_LevelSelector,{ref,...props,allowNoValue:!0,placeholder:"Select Prority",label:showLabel?"Priority":void 0,selectedLevel:priority,setSelectedLevel:selectedLevel=>onEditMetadata(editingStatement,"Priority",selectedLevel)})})),threats_PriorityEdit=PriorityEdit;try{PriorityEdit.displayName="PriorityEdit",PriorityEdit.__docgenInfo={description:"",displayName:"PriorityEdit",props:{showLabel:{defaultValue:{value:"true"},description:"",name:"showLabel",required:!1,type:{name:"boolean"}},editingStatement:{defaultValue:null,description:"",name:"editingStatement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},onEditMetadata:{defaultValue:null,description:"",name:"onEditMetadata",required:!0,type:{name:"(statement: { id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }, key: string, value: string |..."}},onFocus:{defaultValue:null,description:"",name:"onFocus",required:!1,type:{name:"(() => void)"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!1,type:{name:"(() => void)"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"ForwardedRef<any>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/PriorityEdit/index.tsx#PriorityEdit"]={docgenInfo:PriorityEdit.__docgenInfo,name:"PriorityEdit",path:"src/components/threats/PriorityEdit/index.tsx#PriorityEdit"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/threats/ThreatStatementEditor/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>threats_ThreatStatementEditor});var grid=__webpack_require__("../../node_modules/@cloudscape-design/components/grid/index.js"),space_between=__webpack_require__("../../node_modules/@cloudscape-design/components/space-between/index.js"),text_content=__webpack_require__("../../node_modules/@cloudscape-design/components/text-content/index.js"),design_tokens=__webpack_require__("../../node_modules/@cloudscape-design/design-tokens/index.js"),emotion_react_browser_esm=__webpack_require__("../../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),react=__webpack_require__("../../node_modules/react/index.js"),v4=__webpack_require__("../../node_modules/uuid/dist/esm-browser/v4.js"),constants=__webpack_require__("./src/configs/constants.ts"),context=__webpack_require__("./src/contexts/AssumptionLinksContext/context.ts"),AssumptionsContext_context=__webpack_require__("./src/contexts/AssumptionsContext/context.ts"),GlobalSetupContext_context=__webpack_require__("./src/contexts/GlobalSetupContext/context.ts"),MitigationLinksContext_context=__webpack_require__("./src/contexts/MitigationLinksContext/context.ts"),MitigationsContext_context=__webpack_require__("./src/contexts/MitigationsContext/context.ts"),ThreatsContext_context=__webpack_require__("./src/contexts/ThreatsContext/context.ts"),WorkspacesContext_context=__webpack_require__("./src/contexts/WorkspacesContext/context.ts"),threatFieldData=__webpack_require__("./src/data/threatFieldData.ts"),threatStatementExamples=__webpack_require__("./src/data/threatStatementExamples.json"),threatStatementFormat=__webpack_require__("./src/data/threatStatementFormat.ts"),useEditMetadata=__webpack_require__("./src/hooks/useEditMetadata/index.ts"),customTypes=__webpack_require__("./src/customTypes/index.ts"),calculateFieldCombination=__webpack_require__("./src/utils/calculateFieldCombination/index.ts");const allFields=Object.keys(customTypes.threatFieldTypeMapping),getRecommandedEditor=statement=>{if(statement){const{fieldCombination,filledField}=(0,calculateFieldCombination.Z)(statement);if(0!==fieldCombination){const unFilledFields=allFields.filter((af=>!filledField.includes(af))),unFilledFieldsLen=unFilledFields.length;if(1===unFilledFieldsLen)return unFilledFields[0];if(unFilledFieldsLen>1){return unFilledFields[Math.floor(Math.random()*unFilledFieldsLen)]}const randomFieldNum=Math.floor(Math.random()*filledField.length);return filledField[randomFieldNum]}}};var renderThreatStatement=__webpack_require__("./src/utils/renderThreatStatement/index.ts");const utils_scrollToTop=()=>{window.scrollTo({top:0,behavior:"smooth"})};var AssumptionLinkView=__webpack_require__("./src/components/assumptions/AssumptionLinkView/index.tsx"),Tooltip=__webpack_require__("./src/components/generic/Tooltip/index.tsx"),MitigationLinkView=__webpack_require__("./src/components/mitigations/MitigationLinkView/index.tsx"),components_alert=__webpack_require__("../../node_modules/@cloudscape-design/components/alert/index.js"),box=__webpack_require__("../../node_modules/@cloudscape-design/components/box/index.js"),components_button=__webpack_require__("../../node_modules/@cloudscape-design/components/button/index.js"),header=__webpack_require__("../../node_modules/@cloudscape-design/components/header/index.js"),modal=__webpack_require__("../../node_modules/@cloudscape-design/components/modal/index.js"),Textarea=__webpack_require__("./src/components/generic/Textarea/index.tsx"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const CustomTemplate=({visible,setVisible,statement,defaultTemplate,onConfirm})=>{const[value,setValue]=(0,react.useState)(statement?.customTemplate||defaultTemplate),renderedStatement=(0,react.useMemo)((()=>{const{statement:updatedStatement}=(0,renderThreatStatement.Z)({...statement,customTemplate:value===defaultTemplate?void 0:value});return updatedStatement}),[statement,value,defaultTemplate]),footer=(0,react.useMemo)((()=>(0,jsx_runtime.jsx)(box.Z,{float:"right",children:(0,jsx_runtime.jsxs)(space_between.Z,{direction:"horizontal",size:"xs",children:[(0,jsx_runtime.jsx)(components_button.Z,{variant:"link",onClick:()=>setVisible(!1),children:"Cancel"}),(0,jsx_runtime.jsx)(components_button.Z,{onClick:()=>setValue(defaultTemplate),children:"Reset to default"}),(0,jsx_runtime.jsx)(components_button.Z,{variant:"primary",disabled:value.length<3,onClick:()=>onConfirm(value),children:"Confirm"})]})})),[setVisible,onConfirm,value,defaultTemplate]),isUsingDefaultTemplate=value===defaultTemplate;return(0,jsx_runtime.jsx)(modal.Z,{header:(0,jsx_runtime.jsx)(header.Z,{children:"Custom Template"}),visible,footer,onDismiss:()=>setVisible(!1),children:(0,jsx_runtime.jsxs)(space_between.Z,{direction:"vertical",size:"l",children:[(0,jsx_runtime.jsx)(components_alert.Z,{type:"info",header:isUsingDefaultTemplate?"Default template is used":"Custom template is used",children:isUsingDefaultTemplate?"You can create a custom template to control how your statement is renderer. It is only applicable to the currently editing statement.":"You can edit the custom template or reset it to the default template. It is only applicable to the currently editing statement. "}),(0,jsx_runtime.jsxs)(box.Z,{children:[(0,jsx_runtime.jsx)("p",{children:(0,jsx_runtime.jsx)("b",{children:"Renderer Statement:"})}),(0,jsx_runtime.jsx)("p",{children:renderedStatement})]}),(0,jsx_runtime.jsx)(Textarea.Z,{value,onChange:({detail})=>setValue(detail.value),label:"Template",validateData:customTypes.TemplateThreatStatementSchema.shape.customTemplate.safeParse,constraintText:"Tokens like [threat_source], [prerequisites], [threat_action], [threat_impact], [impacted_goal] or [impacted_assets] will be replaced by actual content. "})]})})};CustomTemplate.displayName="CustomTemplate";const threats_CustomTemplate=CustomTemplate;try{CustomTemplate.displayName="CustomTemplate",CustomTemplate.__docgenInfo={description:"",displayName:"CustomTemplate",props:{visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}},setVisible:{defaultValue:null,description:"",name:"setVisible",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"(template: string) => void"}},statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},defaultTemplate:{defaultValue:null,description:"",name:"defaultTemplate",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/CustomTemplate/index.tsx#CustomTemplate"]={docgenInfo:CustomTemplate.__docgenInfo,name:"CustomTemplate",path:"src/components/threats/CustomTemplate/index.tsx#CustomTemplate"})}catch(__react_docgen_typescript_loader_error){}var token_group=__webpack_require__("../../node_modules/@cloudscape-design/components/token-group/index.js"),autosuggest=__webpack_require__("../../node_modules/@cloudscape-design/components/autosuggest/index.js"),form_field=__webpack_require__("../../node_modules/@cloudscape-design/components/form-field/index.js"),useContentValidation=__webpack_require__("./src/hooks/useContentValidation/index.tsx");const Autosuggest=react.forwardRef((({onChange,value,validateData,errorText:_errorText,...props},ref)=>{const[resetErrorText,setResetErrorText]=(0,react.useState)(),{tempValue,errorText,handleChange}=(0,useContentValidation.Z)(value,onChange,validateData),handleKeyDown=(0,react.useCallback)((event=>{8===event.detail.keyCode&&!value&&errorText?setResetErrorText(!0):setResetErrorText(!1),props.onKeyDown?.(event)}),[props.onKeyDown,errorText,value]);return(0,jsx_runtime.jsx)(form_field.Z,{...props,errorText:resetErrorText?void 0:errorText,children:(0,jsx_runtime.jsx)(autosuggest.Z,{...props,ref,value:errorText?value:tempValue,onChange:event=>handleChange(event),onKeyDown:handleKeyDown})})})),generic_Autosuggest=Autosuggest;try{Autosuggest.displayName="Autosuggest",Autosuggest.__docgenInfo={description:"",displayName:"Autosuggest",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"ForwardedRef<any>"}},validateData:{defaultValue:null,description:"",name:"validateData",required:!1,type:{name:"((newValue: string) => SafeParseReturnType<string, string>) | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Autosuggest/index.tsx#Autosuggest"]={docgenInfo:Autosuggest.__docgenInfo,name:"Autosuggest",path:"src/components/generic/Autosuggest/index.tsx#Autosuggest"})}catch(__react_docgen_typescript_loader_error){}var container=__webpack_require__("../../node_modules/@cloudscape-design/components/container/index.js");const EditorLayout_styles={container:(0,emotion_react_browser_esm.iv)({marginTop:design_tokens.OU,marginBottom:design_tokens.UT}),textEditorLayout:(0,emotion_react_browser_esm.iv)({position:"relative"}),input:(0,emotion_react_browser_esm.iv)({display:"inline-block",width:"100%"}),inputClear:(0,emotion_react_browser_esm.iv)({position:"absolute",float:"right",top:"10px",right:"5px"}),inputClearSmall:(0,emotion_react_browser_esm.iv)({position:"absolute",float:"right",top:"1px",right:"5px"})};var emotion_react_jsx_runtime_browser_esm=__webpack_require__("../../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const EditorLayout=({title,description,children,secondaryControl})=>(0,emotion_react_jsx_runtime_browser_esm.tZ)(container.Z,{header:(0,emotion_react_jsx_runtime_browser_esm.tZ)(header.Z,{description,children:title}),footer:secondaryControl,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.container,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(space_between.Z,{direction:"vertical",size:"m",children})})});EditorLayout.displayName="EditorLayout";const threats_EditorLayout=EditorLayout;try{EditorLayout.displayName="EditorLayout",EditorLayout.__docgenInfo={description:"",displayName:"EditorLayout",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"string"}},secondaryControl:{defaultValue:null,description:"",name:"secondaryControl",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorLayout/index.tsx#EditorLayout"]={docgenInfo:EditorLayout.__docgenInfo,name:"EditorLayout",path:"src/components/threats/EditorLayout/index.tsx#EditorLayout"})}catch(__react_docgen_typescript_loader_error){}var input=__webpack_require__("../../node_modules/@cloudscape-design/components/input/index.js"),toggle=__webpack_require__("../../node_modules/@cloudscape-design/components/toggle/index.js"),renderArrayField=__webpack_require__("./src/utils/renderArrayField/index.ts");const utils_shuffle=array=>{const resultArray=[...array];let randomIndex,currentIndex=array.length;for(;0!=currentIndex;)randomIndex=Math.floor(Math.random()*currentIndex),currentIndex--,[resultArray[currentIndex],resultArray[randomIndex]]=[resultArray[randomIndex],resultArray[currentIndex]];return resultArray},ExampleList_styles={list:(0,emotion_react_browser_esm.iv)({"& button":{padding:`0px ${design_tokens.GJg} !important`}})},ExampleList=({examples,onSelect,showSearch=!0})=>{const[showMoreExamples,setShowMoreExamples]=(0,react.useState)(!1),[showFullExample,setShowFullExample]=(0,react.useState)(!1),{threatStatementExamples}=(0,ThreatsContext_context.a)(),[filterText,setFilterText]=(0,react.useState)(""),randomDislayList=(0,react.useMemo)((()=>{let randomExamples=utils_shuffle(examples);return filterText&&(randomExamples=randomExamples.filter((re=>"string"==typeof re?re.toLowerCase().indexOf(filterText)>=0:Array.isArray(re)?re.some((e=>e.toLowerCase().indexOf(filterText)>=0)):re.example.toLowerCase().indexOf(filterText)>=0))),randomExamples}),[examples,filterText]),showFullExampleToggle=(0,react.useMemo)((()=>!!(examples&&examples.length>0)&&("string"!=typeof examples[0]&&!!examples[0].example)),[examples]),renderExample=(0,react.useCallback)((example=>{if("string"==typeof example)return(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"link",onClick:()=>onSelect(example),children:example});if(Array.isArray(example)&&example.length>0&&"string"==typeof example[0]){const exampleStr=(0,renderArrayField.Z)(example);return(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"link",onClick:()=>onSelect(exampleStr),children:exampleStr})}const perFieldExamples=example;if(void 0!==perFieldExamples.fromId&&void 0!==perFieldExamples.example){if(showFullExample){const fullExample=threatStatementExamples[perFieldExamples.fromId].statement;if(fullExample){const index=fullExample.indexOf(perFieldExamples.example);return(0,emotion_react_jsx_runtime_browser_esm.BX)(emotion_react_jsx_runtime_browser_esm.HY,{children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("span",{children:fullExample.slice(0,index)}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"link",onClick:()=>onSelect(perFieldExamples.example),children:perFieldExamples.example}),(0,emotion_react_jsx_runtime_browser_esm.tZ)("span",{children:fullExample.slice(index+perFieldExamples.example.length)})]})}}return(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"link",onClick:()=>onSelect(perFieldExamples.example),children:perFieldExamples.example})}}),[showFullExample,threatStatementExamples]);return(0,emotion_react_jsx_runtime_browser_esm.tZ)(text_content.Z,{children:(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"vertical",size:"m",children:[(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"horizontal",size:"m",children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("span",{children:"Examples:"}),showFullExampleToggle&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(toggle.Z,{checked:showFullExample,onChange:({detail})=>setShowFullExample(detail.checked),children:"Show full examples"})]}),showSearch&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(grid.Z,{gridDefinition:[{colspan:{default:12,xxs:6}}],children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(input.Z,{value:filterText,onChange:({detail})=>setFilterText(detail.value),placeholder:"Search examples"})}),(0,emotion_react_jsx_runtime_browser_esm.tZ)("ul",{children:randomDislayList.slice(0,showMoreExamples?void 0:5).map(((example,index)=>(0,emotion_react_jsx_runtime_browser_esm.tZ)("li",{css:ExampleList_styles.list,children:renderExample(example)},index)))}),randomDislayList.length>5&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{iconName:showMoreExamples?"treeview-collapse":"treeview-expand",onClick:()=>setShowMoreExamples((prev=>!prev)),variant:"link",children:showMoreExamples?"Show less examples":"Show more examples"})]})})};ExampleList.displayName="ExampleList";const threats_ExampleList=ExampleList;try{ExampleList.displayName="ExampleList",ExampleList.__docgenInfo={description:"",displayName:"ExampleList",props:{examples:{defaultValue:null,description:"",name:"examples",required:!0,type:{name:"T[]"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(example: string) => void"}},showSearch:{defaultValue:{value:"true"},description:"",name:"showSearch",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/ExampleList/index.tsx#ExampleList"]={docgenInfo:ExampleList.__docgenInfo,name:"ExampleList",path:"src/components/threats/ExampleList/index.tsx#ExampleList"})}catch(__react_docgen_typescript_loader_error){}const EditorImpactedAssets=(0,react.forwardRef)((({statement,setStatement,fieldData},_ref)=>{const{perFieldExamples,previousInputs}=(0,ThreatsContext_context.a)(),[value,setValue]=(0,react.useState)(""),handleAddAsset=(0,react.useCallback)((asset=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,impactedAssets:prevStatement.impactedAssets?prevStatement.impactedAssets.includes(asset)?[...prevStatement.impactedAssets]:[...prevStatement.impactedAssets,asset]:[asset]})),setValue("")}),[setStatement]),handleSelect=(0,react.useCallback)((({detail})=>{handleAddAsset(detail.value.trim())}),[handleAddAsset]),handleRemoveAsset=(0,react.useCallback)((({detail:{itemIndex}})=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,impactedAssets:prevStatement.impactedAssets?[...prevStatement.impactedAssets?.slice(0,itemIndex),...prevStatement.impactedAssets?.slice(itemIndex+1)]:[]}))}),[setStatement]),handleKeyDown=(0,react.useCallback)((({detail})=>{13===detail.keyCode&&(handleAddAsset?.(value),setValue(""))}),[handleAddAsset,value]);return(0,emotion_react_jsx_runtime_browser_esm.BX)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)(generic_Autosuggest,{onChange:({detail})=>setValue(detail.value),onSelect:handleSelect,value,options:previousInputs.impacted_assets.map((asset=>({value:asset}))),enteredTextLabel:enteredValue=>`Use: "${enteredValue}"`,ariaLabel:"Autosuggest for impacted assets",placeholder:"Select an existing asset or enter new asset",empty:"No matches found",onKeyDown:handleKeyDown,validateData:customTypes.ThreatStatementImpactedAssetItem.safeParse}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(token_group.Z,{onDismiss:handleRemoveAsset,items:statement.impactedAssets?.map((asset=>({label:asset,dismissLabel:`Remove ${asset}`})))}),perFieldExamples.impacted_assets.length>0&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_ExampleList,{examples:perFieldExamples.impacted_assets,onSelect:handleAddAsset,showSearch:!1})]})})),threats_EditorImpactedAssets=EditorImpactedAssets;try{EditorImpactedAssets.displayName="EditorImpactedAssets",EditorImpactedAssets.__docgenInfo={description:"",displayName:"EditorImpactedAssets",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorImpactedAssets/index.tsx#EditorImpactedAssets"]={docgenInfo:EditorImpactedAssets.__docgenInfo,name:"EditorImpactedAssets",path:"src/components/threats/EditorImpactedAssets/index.tsx#EditorImpactedAssets"})}catch(__react_docgen_typescript_loader_error){}const EditorImpactedGoal=(0,react.forwardRef)((({statement,setStatement,fieldData},_ref)=>{const[value,setValue]=(0,react.useState)(""),{perFieldExamples}=(0,ThreatsContext_context.a)(),handleAddImpactedGoal=(0,react.useCallback)((impactedGoal=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,impactedGoal:prevStatement.impactedGoal?prevStatement.impactedGoal.includes(impactedGoal)?[...prevStatement.impactedGoal]:[...prevStatement.impactedGoal,impactedGoal]:[impactedGoal]})),setValue("")}),[setStatement]),handleSelect=(0,react.useCallback)((({detail})=>{handleAddImpactedGoal(detail.value.trim())}),[handleAddImpactedGoal]),handleRemoveImpactedGoal=(0,react.useCallback)((({detail:{itemIndex}})=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,impactedGoal:prevStatement.impactedGoal?[...prevStatement.impactedGoal?.slice(0,itemIndex),...prevStatement.impactedGoal?.slice(itemIndex+1)]:[]}))}),[setStatement]),handleExampleClicked=(0,react.useCallback)((example=>{example.replace("and/or","").replace("and","").replace("or","").split(/[\s,]+/).forEach((token=>handleAddImpactedGoal(token)))}),[handleAddImpactedGoal]),handleKeyDown=(0,react.useCallback)((({detail})=>{13===detail.keyCode&&(handleAddImpactedGoal?.(value),setValue(""))}),[handleAddImpactedGoal,value]);return(0,emotion_react_jsx_runtime_browser_esm.BX)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)(generic_Autosuggest,{onChange:({detail})=>setValue(detail.value),onSelect:handleSelect,value,options:fieldData.tokens?.map((token=>({value:token}))),enteredTextLabel:enteredValue=>`Use: "${enteredValue}"`,ariaLabel:"Autosuggest for impacted goals",placeholder:"Select an impacted goal or enter new one",empty:"No matches found",onKeyDown:handleKeyDown,validateData:customTypes.ThreatStatementImpactedGoalItem.safeParse}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(token_group.Z,{onDismiss:handleRemoveImpactedGoal,items:statement.impactedGoal?.map((goal=>({label:goal,dismissLabel:`Remove ${goal}`})))}),perFieldExamples.impacted_goal.length>0&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_ExampleList,{examples:perFieldExamples.impacted_goal,onSelect:handleExampleClicked,showSearch:!1})]})})),threats_EditorImpactedGoal=EditorImpactedGoal;try{EditorImpactedGoal.displayName="EditorImpactedGoal",EditorImpactedGoal.__docgenInfo={description:"",displayName:"EditorImpactedGoal",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorImpactedGoal/index.tsx#EditorImpactedGoal"]={docgenInfo:EditorImpactedGoal.__docgenInfo,name:"EditorImpactedGoal",path:"src/components/threats/EditorImpactedGoal/index.tsx#EditorImpactedGoal"})}catch(__react_docgen_typescript_loader_error){}const EditorPrerequisites=(0,react.forwardRef)((({statement,setStatement,fieldData},ref)=>{const inputRef=(0,react.useRef)(),{perFieldExamples}=(0,ThreatsContext_context.a)();(0,react.useImperativeHandle)(ref,(()=>({focus(){inputRef.current?.focus()}})),[]);const handleChange=(0,react.useCallback)((prerequisites=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,prerequisites}))}),[setStatement]),handleSelect=(0,react.useCallback)((prerequisites=>{handleChange(prerequisites),inputRef.current?.focus()}),[handleChange]);return(0,emotion_react_jsx_runtime_browser_esm.BX)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.BX)("div",{css:EditorLayout_styles.textEditorLayout,children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.input,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(Textarea.Z,{ref:inputRef,onChange:({detail})=>handleChange(detail.value),value:statement.prerequisites||"",placeholder:"Enter prerequisites",spellcheck:!0,singleLine:!0,validateData:customTypes.TemplateThreatStatementSchema.shape.prerequisites.safeParse,rows:2,stretch:!0})}),statement.prerequisites&&(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.inputClear,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"icon",iconName:"close",onClick:()=>handleChange("")})})]}),perFieldExamples.prerequisites.length>0&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_ExampleList,{examples:perFieldExamples.prerequisites,onSelect:handleSelect})]})})),threats_EditorPrerequisites=EditorPrerequisites;try{EditorPrerequisites.displayName="EditorPrerequisites",EditorPrerequisites.__docgenInfo={description:"",displayName:"EditorPrerequisites",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorPrerequisites/index.tsx#EditorPrerequisites"]={docgenInfo:EditorPrerequisites.__docgenInfo,name:"EditorPrerequisites",path:"src/components/threats/EditorPrerequisites/index.tsx#EditorPrerequisites"})}catch(__react_docgen_typescript_loader_error){}var ThreatsContext=__webpack_require__("./src/contexts/ThreatsContext/index.tsx");const EditorThreatAction=(0,react.forwardRef)((({statement,setStatement,fieldData},ref)=>{const inputRef=(0,react.useRef)(),{perFieldExamples}=(0,ThreatsContext.a)();(0,react.useImperativeHandle)(ref,(()=>({focus(){inputRef.current?.focus()}})),[]);const handleChange=(0,react.useCallback)((threatAction=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,threatAction}))}),[setStatement]),handleSelect=(0,react.useCallback)((threatAction=>{handleChange(threatAction),inputRef.current?.focus()}),[handleChange]);return(0,emotion_react_jsx_runtime_browser_esm.BX)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.BX)("div",{css:EditorLayout_styles.textEditorLayout,children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.input,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(Textarea.Z,{ref:inputRef,spellcheck:!0,onChange:({detail})=>handleChange(detail.value),value:statement.threatAction||"",placeholder:"Enter threat action",validateData:customTypes.TemplateThreatStatementSchema.shape.threatAction.safeParse,rows:2,singleLine:!0,stretch:!0})}),statement.threatAction&&(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.inputClear,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"icon",iconName:"close",onClick:()=>handleChange("")})})]}),perFieldExamples.threat_action.length>0&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_ExampleList,{examples:perFieldExamples.threat_action,onSelect:handleSelect})]})})),threats_EditorThreatAction=EditorThreatAction;try{EditorThreatAction.displayName="EditorThreatAction",EditorThreatAction.__docgenInfo={description:"",displayName:"EditorThreatAction",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorThreatAction/index.tsx#EditorThreatAction"]={docgenInfo:EditorThreatAction.__docgenInfo,name:"EditorThreatAction",path:"src/components/threats/EditorThreatAction/index.tsx#EditorThreatAction"})}catch(__react_docgen_typescript_loader_error){}const EditorThreatImpact=(0,react.forwardRef)((({statement,setStatement,fieldData},ref)=>{const inputRef=(0,react.useRef)(),{perFieldExamples}=(0,ThreatsContext.a)();(0,react.useImperativeHandle)(ref,(()=>({focus(){inputRef.current?.focus()}})),[]);const handleChange=(0,react.useCallback)((threatImpact=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,threatImpact}))}),[setStatement]),handleSelect=(0,react.useCallback)((threatImpact=>{handleChange(threatImpact),inputRef.current?.focus()}),[handleChange]);return(0,emotion_react_jsx_runtime_browser_esm.BX)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.BX)("div",{css:EditorLayout_styles.textEditorLayout,children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.input,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(Textarea.Z,{ref:inputRef,spellcheck:!0,onChange:({detail})=>handleChange(detail.value),value:statement.threatImpact||"",placeholder:"Enter threat impact",validateData:customTypes.TemplateThreatStatementSchema.shape.threatImpact.safeParse,rows:2,singleLine:!0,stretch:!0})}),statement.threatImpact&&(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.inputClear,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"icon",iconName:"close",onClick:()=>handleChange("")})})]}),perFieldExamples.threat_impact.length>0&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_ExampleList,{examples:perFieldExamples.threat_impact,onSelect:handleSelect})]})})),threats_EditorThreatImpact=EditorThreatImpact;try{EditorThreatImpact.displayName="EditorThreatImpact",EditorThreatImpact.__docgenInfo={description:"",displayName:"EditorThreatImpact",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorThreatImpact/index.tsx#EditorThreatImpact"]={docgenInfo:EditorThreatImpact.__docgenInfo,name:"EditorThreatImpact",path:"src/components/threats/EditorThreatImpact/index.tsx#EditorThreatImpact"})}catch(__react_docgen_typescript_loader_error){}var column_layout=__webpack_require__("../../node_modules/@cloudscape-design/components/column-layout/index.js"),Input=__webpack_require__("./src/components/generic/Input/index.tsx");const EditorThreatSource=(0,react.forwardRef)((({statement,setStatement,fieldData},ref)=>{const{perFieldExamples,previousInputs}=(0,ThreatsContext_context.a)(),valueRef=(0,react.useRef)(statement.threatSource);(0,react.useEffect)((()=>{valueRef.current=statement.threatSource?.trim()}),[statement.threatSource]);const handleChange=(0,react.useCallback)((threatSource=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,threatSource}))}),[setStatement]);return(0,emotion_react_jsx_runtime_browser_esm.BX)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.BX)("div",{css:EditorLayout_styles.textEditorLayout,children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.input,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(Input.Z,{ref,spellcheck:!0,onChange:({detail})=>handleChange(detail.value),value:statement.threatSource||"",placeholder:"Enter threat source",validateData:customTypes.TemplateThreatStatementSchema.shape.threatSource.safeParse,stretch:!0})}),statement.threatSource&&(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:EditorLayout_styles.inputClearSmall,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"icon",iconName:"close",onClick:()=>handleChange("")})})]}),(0,emotion_react_jsx_runtime_browser_esm.BX)(column_layout.Z,{columns:previousInputs.threat_source.length>0?2:1,children:[perFieldExamples.threat_source.length>0&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_ExampleList,{examples:perFieldExamples.threat_source,onSelect:handleChange,showSearch:!1}),previousInputs.threat_source.length>0&&(0,emotion_react_jsx_runtime_browser_esm.BX)(text_content.Z,{children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("span",{children:"From previous input"}),(0,emotion_react_jsx_runtime_browser_esm.tZ)("ul",{children:previousInputs.threat_source.map(((threatSource,index)=>(0,emotion_react_jsx_runtime_browser_esm.tZ)("li",{children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"link",onClick:()=>handleChange(threatSource),children:threatSource})},index)))})]})]})]})})),threats_EditorThreatSource=EditorThreatSource;try{EditorThreatSource.displayName="EditorThreatSource",EditorThreatSource.__docgenInfo={description:"",displayName:"EditorThreatSource",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorThreatSource/index.tsx#EditorThreatSource"]={docgenInfo:EditorThreatSource.__docgenInfo,name:"EditorThreatSource",path:"src/components/threats/EditorThreatSource/index.tsx#EditorThreatSource"})}catch(__react_docgen_typescript_loader_error){}var button_dropdown=__webpack_require__("../../node_modules/@cloudscape-design/components/button-dropdown/index.js");const ExpandableToken=({expanded,onClick,tooltip})=>(0,jsx_runtime.jsx)(Tooltip.Z,{tooltip,children:(0,jsx_runtime.jsx)(components_button.Z,{iconName:expanded?"treeview-collapse":"treeview-expand",variant:"icon",onClick})});ExpandableToken.displayName="ExpandableToken";const components_ExpandableToken=ExpandableToken;try{ExpandableToken.displayName="ExpandableToken",ExpandableToken.__docgenInfo={description:"",displayName:"ExpandableToken",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void)"}},expanded:{defaultValue:null,description:"",name:"expanded",required:!0,type:{name:"boolean"}},tooltip:{defaultValue:null,description:"",name:"tooltip",required:!0,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FieldSelector/components/ExpandableToken/index.tsx#ExpandableToken"]={docgenInfo:ExpandableToken.__docgenInfo,name:"ExpandableToken",path:"src/components/threats/FieldSelector/components/ExpandableToken/index.tsx#ExpandableToken"})}catch(__react_docgen_typescript_loader_error){}const Token=({children,onClick,highlighted,filled,tooltip})=>{const bgColor=highlighted?design_tokens.NBP:filled?design_tokens.Gg4:design_tokens.MXp;return(0,emotion_react_jsx_runtime_browser_esm.tZ)(Tooltip.Z,{tooltip,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)("button",{css:emotion_react_browser_esm.iv`
        text-align: left;
        text-decoration: none;
        border-spacing: 0;
        border-collapse: separate;
        border: 1px solid;
        border-radius: ${design_tokens.OL$};
        height: fit-content !important;
        padding: ${design_tokens.t5V};
        color: ${design_tokens.zeK};
        background-color: ${bgColor};
      `,onClick,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)("span",{children})})})};Token.displayName="Token";const components_Token=Token;try{Token.displayName="Token",Token.__docgenInfo={description:"",displayName:"Token",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}},highlighted:{defaultValue:null,description:"",name:"highlighted",required:!1,type:{name:"boolean"}},filled:{defaultValue:null,description:"",name:"filled",required:!1,type:{name:"boolean"}},tooltip:{defaultValue:null,description:"",name:"tooltip",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FieldSelector/components/Token/index.tsx#Token"]={docgenInfo:Token.__docgenInfo,name:"Token",path:"src/components/threats/FieldSelector/components/Token/index.tsx#Token"})}catch(__react_docgen_typescript_loader_error){}var parseThreatStatement=__webpack_require__("./src/utils/parseThreatStatement/index.ts"),expandable_section=__webpack_require__("../../node_modules/@cloudscape-design/components/expandable-section/index.js"),getMobileMediaQuery=__webpack_require__("./src/utils/getMobileMediaQuery/index.tsx");const Suggestions_styles={suggestionGroups:(0,emotion_react_browser_esm.iv)({display:"table"}),suggestionGroup:(0,emotion_react_browser_esm.iv)({display:"table-row"}),suggestionButtonWrapper:(0,emotion_react_browser_esm.iv)({display:"table-cell","& > button > span":{whiteSpace:"nowrap"},[(0,getMobileMediaQuery.Z)()]:{display:"block"}}),suggestion:(0,emotion_react_browser_esm.iv)({display:"table-cell",alignSelf:"center",[(0,getMobileMediaQuery.Z)()]:{display:"block"}})},Suggestions=({suggestions,setEditor})=>{const[showMoresuggestions,setShowMoresuggestions]=(0,react.useState)(suggestions&&suggestions?.length>2),suggestionGroups=(0,react.useMemo)((()=>suggestions?.reduce(((group,suggestion)=>{if(0===suggestion.indexOf("[")){const endIndex=suggestion.indexOf("]"),token=suggestion.slice(1,endIndex),content=suggestion.slice(endIndex+1).trim();return{...group,[token]:group[token]?[...group[token],content]:[content]}}return{...group,GENERAL:group.GENERAL?[...group.GENERAL,suggestion]:[suggestion]}}),{})),[suggestions]),renderSuggestionGroup=(0,react.useCallback)(((groups,token)=>{const group=groups[token];return(0,emotion_react_jsx_runtime_browser_esm.BX)("div",{css:Suggestions_styles.suggestionGroup,children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:Suggestions_styles.suggestionButtonWrapper,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"link",onClick:()=>setEditor(token),children:"GENERAL"!==token&&group&&threatFieldData.Z[token]?.displayTitle})}),(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:Suggestions_styles.suggestion,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(space_between.Z,{direction:"vertical",size:"xxxs",children:group.map(((r,index)=>(0,emotion_react_jsx_runtime_browser_esm.BX)("div",{children:["- ",r]},index)))})})]},token)}),[setEditor]);return suggestions&&suggestions.length>0&&suggestionGroups?(0,emotion_react_jsx_runtime_browser_esm.tZ)(expandable_section.Z,{headerText:`Suggestions (${suggestions.length})`,defaultExpanded:!0,children:(0,emotion_react_jsx_runtime_browser_esm.BX)(text_content.Z,{children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:Suggestions_styles.suggestionGroups,children:Object.keys(suggestionGroups).slice(0,showMoresuggestions?Object.keys(suggestionGroups).length:2).map((token=>renderSuggestionGroup(suggestionGroups,token)))}),Object.keys(suggestionGroups).length>2&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{iconName:showMoresuggestions?"treeview-collapse":"treeview-expand",onClick:()=>setShowMoresuggestions((prev=>!prev)),variant:"link",children:showMoresuggestions?"Show less suggestions":"Show more suggestions"})]})}):null},threats_Suggestions=Suggestions;try{Suggestions.displayName="Suggestions",Suggestions.__docgenInfo={description:"",displayName:"Suggestions",props:{suggestions:{defaultValue:null,description:"",name:"suggestions",required:!1,type:{name:"string[]"}},setEditor:{defaultValue:null,description:"",name:"setEditor",required:!0,type:{name:"(type: ThreatFieldTypes) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/Suggestions/index.tsx#Suggestions"]={docgenInfo:Suggestions.__docgenInfo,name:"Suggestions",path:"src/components/threats/Suggestions/index.tsx#Suggestions"})}catch(__react_docgen_typescript_loader_error){}const defaultThreatStatementFormat=threatStatementFormat.Z[63],FieldSelector_styles={selector:(0,emotion_react_browser_esm.iv)({lineHeight:"2.5"})},FieldSelector=({composerMode,onStartOver,setEditor,currentEditor,statement,suggestions,onGiveExampleClick,setCustomTemplateEditorVisible})=>{const[expandedImpactedGoal,setExpandedImpactedGoal]=(0,react.useState)(!1);(0,react.useEffect)((()=>{"impacted_goal"===currentEditor&&setExpandedImpactedGoal(!0)}),[currentEditor]),(0,react.useEffect)((()=>{setExpandedImpactedGoal(!1)}),[statement]);const{showInfoModal}=(0,GlobalSetupContext_context.n)(),selector=(0,react.useMemo)((()=>{let renderShortenImpactedGoal=!1,template=statement.customTemplate||defaultThreatStatementFormat.template;return(0,parseThreatStatement.Z)({statement,template,outputProcessor:(token,content,before,filled)=>{const output=[];return"impacted_goal"!==token||expandedImpactedGoal||filled||statement.customTemplate?(renderShortenImpactedGoal?output.push("negatively impacting "):output.push(before),output.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_Token,{highlighted:currentEditor===token,filled:!!filled,tooltip:threatFieldData.Z[token]?.tooltip,onClick:()=>setEditor(token),children:content},token)),"impacted_goal"===token&&!filled&&output.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_ExpandableToken,{expanded:!0,tooltip:`Collapse ${threatFieldData.Z[token]?.tooltip}`,onClick:()=>{setExpandedImpactedGoal(!1);const nextEditor=getRecommandedEditor(statement);nextEditor&&setEditor(nextEditor)}},"field_selector_impacted_goal_collpase"))):(output.push(","),output.push((0,emotion_react_jsx_runtime_browser_esm.tZ)(components_ExpandableToken,{tooltip:`Expand ${threatFieldData.Z[token]?.tooltip}`,expanded:!1,onClick:()=>{setExpandedImpactedGoal(!0),setEditor("impacted_goal")}},"field_selector_impacted_goal_expand")),renderShortenImpactedGoal=!0),output}})}),[statement,setEditor,currentEditor,suggestions,expandedImpactedGoal,setExpandedImpactedGoal]),handleMoreActions=(0,react.useCallback)((({detail})=>{if("customTemplate"===detail.id)setCustomTemplateEditorVisible(!0);else console.log("Unknown action",detail.id)}),[setCustomTemplateEditorVisible]);return(0,emotion_react_jsx_runtime_browser_esm.tZ)(container.Z,{header:(0,emotion_react_jsx_runtime_browser_esm.tZ)(header.Z,{info:"Full"===composerMode?void 0:(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"icon",iconName:"status-info",onClick:showInfoModal}),actions:(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"horizontal",size:"s",children:["EditorOnly"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:onStartOver,children:"Start over"}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:onGiveExampleClick,children:"Give me a random example"}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(button_dropdown.Z,{items:[{id:"customTemplate",text:"Custom Template"}],ariaLabel:"More actions",variant:"icon",onItemClick:handleMoreActions})]}),description:"Start by clicking ANY field you like and work from there...",children:"Let's write a threat statement!"}),children:(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"vertical",size:"s",children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)(text_content.Z,{children:(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:FieldSelector_styles.selector,children:selector})}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_Suggestions,{suggestions,setEditor})]})})};FieldSelector.displayName="FieldSelector";const threats_FieldSelector=FieldSelector;try{FieldSelector.displayName="FieldSelector",FieldSelector.__docgenInfo={description:"",displayName:"FieldSelector",props:{composerMode:{defaultValue:null,description:"",name:"composerMode",required:!0,type:{name:"enum",value:[{value:'"ThreatsOnly"'},{value:'"EditorOnly"'},{value:'"Full"'}]}},currentEditor:{defaultValue:null,description:"",name:"currentEditor",required:!1,type:{name:"enum",value:[{value:'"prerequisites"'},{value:'"threat_source"'},{value:'"threat_action"'},{value:'"threat_impact"'},{value:'"impacted_goal"'},{value:'"impacted_assets"'}]}},setEditor:{defaultValue:null,description:"",name:"setEditor",required:!0,type:{name:"(type: ThreatFieldTypes) => void"}},statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},suggestions:{defaultValue:null,description:"",name:"suggestions",required:!1,type:{name:"string[]"}},onGiveExampleClick:{defaultValue:null,description:"",name:"onGiveExampleClick",required:!0,type:{name:"() => void"}},setCustomTemplateEditorVisible:{defaultValue:null,description:"",name:"setCustomTemplateEditorVisible",required:!0,type:{name:"(visible: boolean) => void"}},onStartOver:{defaultValue:null,description:"",name:"onStartOver",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FieldSelector/index.tsx#FieldSelector"]={docgenInfo:FieldSelector.__docgenInfo,name:"FieldSelector",path:"src/components/threats/FieldSelector/index.tsx#FieldSelector"})}catch(__react_docgen_typescript_loader_error){}var CopyToClipboard=__webpack_require__("./src/components/generic/CopyToClipboard/index.tsx");const FinalStatement=({statement,displayStatement})=>(0,emotion_react_jsx_runtime_browser_esm.tZ)(text_content.Z,{children:(0,emotion_react_jsx_runtime_browser_esm.tZ)("p",{css:emotion_react_browser_esm.iv`
        font-size: 20px !important;
        line-height: 1.5 !important;
      `,children:(statement.statement||displayStatement&&displayStatement.length>0)&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(CopyToClipboard.Z,{content:statement.statement,children:displayStatement||statement.statement})})});FinalStatement.displayName="FinalStatement";const threats_FinalStatement=FinalStatement;try{FinalStatement.displayName="FinalStatement",FinalStatement.__docgenInfo={description:"",displayName:"FinalStatement",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},displayStatement:{defaultValue:null,description:"",name:"displayStatement",required:!1,type:{name:"ReactNode[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FinalStatement/index.tsx#FinalStatement"]={docgenInfo:FinalStatement.__docgenInfo,name:"FinalStatement",path:"src/components/threats/FinalStatement/index.tsx#FinalStatement"})}catch(__react_docgen_typescript_loader_error){}var property_filter=__webpack_require__("../../node_modules/@cloudscape-design/components/property-filter/index.js"),stride=__webpack_require__("./src/data/stride.ts");const intersection=(arr1,arr2)=>{const res=[];for(let i=0;i<arr1.length;i++)arr2.includes(arr1[i])&&res.push(arr1[i]);return res},utils_intersectArrays=(...arrs)=>{let res=arrs[0].slice();for(let i=1;i<arrs.length;i++)res=intersection(res,arrs[i]);return res},FullExamples=(0,react.forwardRef)((({onClick},ref)=>{const{threatStatementExamples}=(0,ThreatsContext_context.a)(),[expanded,setExpanded]=(0,react.useState)(!1),[query,setQuery]=(0,react.useState)({tokens:[],operation:"and"});(0,react.useImperativeHandle)(ref,(()=>({collapse(){setExpanded(!1)}})),[]);const handleClick=(0,react.useCallback)((example=>{setExpanded(!1),onClick?.(example)}),[onClick]),filteredThreatStatementList=(0,react.useMemo)((()=>{let resultExamples=[...threatStatementExamples];if(query.tokens.length>0){const queryResult=query.tokens.map((t=>((statements,token)=>{const targetValue=token.value?.slice(0,1).toUpperCase(),result=[];return statements.forEach(((st,index)=>{if("STRIDE"===token.propertyKey){const value=st.metadata?.find((m=>"STRIDE"===m.key))?.value;value||"!="!==token.operator||result.push(index),value&&"="===token.operator&&value.includes(targetValue)&&result.push(index),"="===token.operator||value&&value.includes(targetValue)||result.push(index)}else(token.propertyKey||":"!==token.operator||st.statement&&st.statement.toLocaleLowerCase().indexOf(token.value)>=0)&&result.push(index)})),result})(threatStatementExamples,t)));let mergeResult=[];mergeResult=1===queryResult.length?queryResult[0]:"or"===query.operation?queryResult.reduce(((arr,cur)=>{const result=[...arr];return cur.forEach((n=>{result.includes(n)||result.push(n)})),result}),[]):utils_intersectArrays(...queryResult),resultExamples=resultExamples.filter(((_r,index)=>mergeResult.includes(index)))}return utils_shuffle(resultExamples)}),[threatStatementExamples,query]),filteringOptions=(0,react.useMemo)((()=>{const options=[];return options.push(...stride.Z.map((v=>({propertyKey:"STRIDE",value:v.label})))),options}),[]),filteringProperties=(0,react.useMemo)((()=>[{key:"STRIDE",operators:["=","!="],propertyLabel:"STRIDE",groupValuesLabel:"STRIDE values"}]),[]);return(0,jsx_runtime.jsx)(expandable_section.Z,{headerText:"Full examples",expanded,onChange:({detail})=>setExpanded(detail.expanded),children:(0,jsx_runtime.jsx)(box.Z,{padding:"m",children:(0,jsx_runtime.jsxs)(space_between.Z,{direction:"vertical",size:"m",children:[(0,jsx_runtime.jsx)(property_filter.Z,{onChange:({detail})=>setQuery(detail),query,i18nStrings:{filteringAriaLabel:"your choice",dismissAriaLabel:"Dismiss",filteringPlaceholder:"Filter examples by metadata or content",groupValuesText:"Values",groupPropertiesText:"Properties",operatorsText:"Operators",operationAndText:"and",operationOrText:"or",operatorLessText:"Less than",operatorLessOrEqualText:"Less than or equal",operatorGreaterText:"Greater than",operatorGreaterOrEqualText:"Greater than or equal",operatorContainsText:"Contains",operatorDoesNotContainText:"Does not contain",operatorEqualsText:"Equals",operatorDoesNotEqualText:"Does not equal",editTokenHeader:"Edit filter",propertyText:"Property",operatorText:"Operator",valueText:"Value",cancelActionText:"Cancel",applyActionText:"Apply",allPropertiesLabel:"All properties",tokenLimitShowMore:"Show more",tokenLimitShowFewer:"Show fewer",clearFiltersText:"Clear filters",removeTokenButtonAriaLabel:token=>`Remove token ${token.propertyKey} ${token.operator} ${token.value}`,enteredTextLabel:text=>`Use: "${text}"`},countText:`${filteredThreatStatementList.length} matches`,expandToViewport:!0,filteringOptions,filteringProperties}),(0,jsx_runtime.jsx)(text_content.Z,{children:(0,jsx_runtime.jsx)("ul",{children:filteredThreatStatementList.map(((example,index)=>(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)(components_button.Z,{onClick:()=>handleClick(example),variant:"link",children:example.statement})},index)))})})]})})})})),threats_FullExamples=FullExamples;try{FullExamples.displayName="FullExamples",FullExamples.__docgenInfo={description:"",displayName:"FullExamples",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(example: { id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }) => void"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"ForwardedRef<any>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FullExamples/index.tsx#FullExamples"]={docgenInfo:FullExamples.__docgenInfo,name:"FullExamples",path:"src/components/threats/FullExamples/index.tsx#FullExamples"})}catch(__react_docgen_typescript_loader_error){}const Header=({statement,saveButtonText,onComplete,onCancel,onStartOver})=>{const actions=(0,react.useMemo)((()=>(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"horizontal",size:"xs",children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:onCancel,children:"Threat list"}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{onClick:onStartOver,children:"Start over"}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(components_button.Z,{variant:"primary",onClick:onComplete,disabled:!statement.statement,children:saveButtonText})]})),[onComplete,onCancel,onStartOver]);return(0,emotion_react_jsx_runtime_browser_esm.tZ)(header.Z,{variant:"h1",actions,children:statement.numericId&&-1!==statement.numericId?`Threat ${statement.numericId}`:void 0})};Header.displayName="Header";const threats_Header=Header;try{Header.displayName="Header",Header.__docgenInfo={description:"",displayName:"Header",props:{composerMode:{defaultValue:null,description:"",name:"composerMode",required:!0,type:{name:"enum",value:[{value:'"ThreatsOnly"'},{value:'"EditorOnly"'},{value:'"Full"'}]}},saveButtonText:{defaultValue:null,description:"",name:"saveButtonText",required:!0,type:{name:"string"}},statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"(() => void)"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"(() => void)"}},onStartOver:{defaultValue:null,description:"",name:"onStartOver",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/Header/index.tsx#Header"]={docgenInfo:Header.__docgenInfo,name:"Header",path:"src/components/threats/Header/index.tsx#Header"})}catch(__react_docgen_typescript_loader_error){}var MetadataEditor=__webpack_require__("./src/components/threats/MetadataEditor/index.tsx"),status_indicator=__webpack_require__("../../node_modules/@cloudscape-design/components/status-indicator/index.js");const Status_styles=(0,emotion_react_browser_esm.iv)({background:"transparent",border:"none !important",cursor:"pointer"}),Status=({completed,label,onClick})=>(0,emotion_react_jsx_runtime_browser_esm.tZ)("button",{css:Status_styles,onClick,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(status_indicator.Z,{type:completed?"success":"stopped",children:label})});Status.displayName="Status";const components_Status=Status;try{Status.displayName="Status",Status.__docgenInfo={description:"",displayName:"Status",props:{completed:{defaultValue:null,description:"",name:"completed",required:!1,type:{name:"boolean"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/Metrics/components/Status/index.tsx#Status"]={docgenInfo:Status.__docgenInfo,name:"Status",path:"src/components/threats/Metrics/components/Status/index.tsx#Status"})}catch(__react_docgen_typescript_loader_error){}const Metrics=({statement,onClick})=>(0,jsx_runtime.jsx)(container.Z,{children:(0,jsx_runtime.jsxs)(space_between.Z,{direction:"vertical",size:"s",children:[(0,jsx_runtime.jsx)(text_content.Z,{children:(0,jsx_runtime.jsx)("h5",{children:"Inputs for mitigation"})}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.Z.threat_source.displayTitle,onClick:()=>onClick("threat_source"),completed:!!statement.threatSource}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.Z.prerequisites.displayTitle,onClick:()=>onClick("prerequisites"),completed:!!statement.prerequisites}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.Z.threat_action.displayTitle,onClick:()=>onClick("threat_action"),completed:!!statement.threatAction}),(0,jsx_runtime.jsxs)(text_content.Z,{children:[(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsx)("h5",{children:"Inputs for prioritization"})]}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.Z.threat_impact.displayTitle,onClick:()=>onClick("threat_impact"),completed:!!statement.threatImpact}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.Z.impacted_goal.displayTitle,onClick:()=>onClick("impacted_goal"),completed:!!statement.impactedGoal&&statement.impactedGoal.length>0}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.Z.impacted_assets.displayTitle,onClick:()=>onClick("impacted_assets"),completed:!!statement.impactedAssets&&statement.impactedAssets.length>0})]})});Metrics.displayName="Metrics";const threats_Metrics=Metrics;try{Metrics.displayName="Metrics",Metrics.__docgenInfo={description:"",displayName:"Metrics",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; tags?: string[] | undefined; displayOrder?: number | undefined; metadata?: { value: (string | string[]) & (string | string[] | undefined); key: string; }[] | undefined; ... 8 more ...; displayedStatement?: (string | { ...; })[] | undefined; }"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(token: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/Metrics/index.tsx#Metrics"]={docgenInfo:Metrics.__docgenInfo,name:"Metrics",path:"src/components/threats/Metrics/index.tsx#Metrics"})}catch(__react_docgen_typescript_loader_error){}const ThreatStatementEditor_styles={finalStatementSection:(0,emotion_react_browser_esm.iv)({"&:hover":{backgroundColor:design_tokens._De}}),metadataContainer:(0,emotion_react_browser_esm.iv)({"h3>span>span":{fontSize:"20px"}})},ThreatStatementEditor_defaultThreatStatementFormat=threatStatementFormat.Z[63],editorMapping={threat_source:threats_EditorThreatSource,prerequisites:threats_EditorPrerequisites,threat_action:threats_EditorThreatAction,threat_impact:threats_EditorThreatImpact,impacted_goal:threats_EditorImpactedGoal,impacted_assets:threats_EditorImpactedAssets},ThreatStatementEditorInner=({editingStatement})=>{const{setEditingStatement,saveStatement,addStatement,onThreatListView}=(0,ThreatsContext_context.a)(),inputRef=(0,react.useRef)(),fullExamplesRef=(0,react.useRef)(),{currentWorkspace,workspaceList}=(0,WorkspacesContext_context.$)(),[editor,setEditor]=(0,react.useState)(getRecommandedEditor(editingStatement)),[suggestions,setSuggestions]=(0,react.useState)([]),[displayStatement,setDisplayStatement]=(0,react.useState)([]),[customTemplateEditorVisible,setCustomTemplateEditorVisible]=(0,react.useState)(!1),{addAssumptionLinks,getLinkedAssumptionLinks,removeAssumptionLinks}=(0,context._)(),{addMitigationLinks,getLinkedMitigationLinks,removeMitigationLinks}=(0,MitigationLinksContext_context.e)(),prevLinkedAssumptionIds=(0,react.useMemo)((()=>getLinkedAssumptionLinks(editingStatement.id).map((la=>la.assumptionId))),[getLinkedAssumptionLinks,editingStatement]),prevLinkedMitigationIds=(0,react.useMemo)((()=>getLinkedMitigationLinks(editingStatement.id).map((lm=>lm.mitigationId))),[getLinkedMitigationLinks,editingStatement]),[linkedAssumptionIds,setLinkedAssumptionIds]=(0,react.useState)(editingStatement&&-1===editingStatement?.numericId?[]:prevLinkedAssumptionIds),[linkedMitigationIds,setLinkedMitigationIds]=(0,react.useState)(editingStatement&&-1===editingStatement?.numericId?[]:prevLinkedMitigationIds),{composerMode}=(0,GlobalSetupContext_context.n)(),{assumptionList,saveAssumption}=(0,AssumptionsContext_context.H)(),{mitigationList,saveMitigation}=(0,MitigationsContext_context.I)(),Component=(0,react.useMemo)((()=>editor&&editorMapping[editor]),[editor]),handleCancel=(0,react.useCallback)((()=>{setEditingStatement(null),onThreatListView?.()}),[setEditingStatement,onThreatListView]);(0,react.useEffect)((()=>{inputRef.current?.focus()}),[editor]),(0,react.useEffect)((()=>{if(editingStatement){const{statement,suggestions:currentSuggestions,displayedStatement}=(0,renderThreatStatement.Z)(editingStatement);statement!==editingStatement.statement&&setEditingStatement((prev=>prev&&{...prev,statement,displayedStatement}));const displayedHtml=displayedStatement?.map(((s,index)=>"string"==typeof s?s:"b"===s.type?(0,emotion_react_jsx_runtime_browser_esm.tZ)(Tooltip.Z,{tooltip:s.tooltip,anchor:"EditorOnly"===composerMode?"bottom":"top",children:(0,emotion_react_jsx_runtime_browser_esm.tZ)("b",{css:ThreatStatementEditor_styles.finalStatementSection,children:s.content})},index):"span"===s.type?(0,emotion_react_jsx_runtime_browser_esm.tZ)(Tooltip.Z,{tooltip:s.tooltip,anchor:"EditorOnly"===composerMode?"bottom":"top",children:(0,emotion_react_jsx_runtime_browser_esm.tZ)("span",{css:ThreatStatementEditor_styles.finalStatementSection,children:s.content})},index):(0,emotion_react_jsx_runtime_browser_esm.tZ)(emotion_react_jsx_runtime_browser_esm.HY,{children:s.content})));setDisplayStatement(displayedHtml),setSuggestions(currentSuggestions)}else setSuggestions([]),setDisplayStatement([])}),[editingStatement,composerMode]);const handleStartOver=(0,react.useCallback)((()=>{addStatement(),setEditor(void 0),fullExamplesRef.current?.collapse()}),[addStatement]),handleComplete=(0,react.useCallback)((()=>{if(editingStatement){saveStatement(editingStatement);const id=editingStatement.id;if(-1===editingStatement.numericId)linkedAssumptionIds&&linkedAssumptionIds.length>0&&addAssumptionLinks(linkedAssumptionIds.map((la=>({assumptionId:la,linkedId:id,type:"Threat"})))),linkedMitigationIds&&linkedMitigationIds.length>0&&addMitigationLinks(linkedMitigationIds.map((lm=>({mitigationId:lm,linkedId:id}))));else{const toAddlinkedAssumptionIds=linkedAssumptionIds.filter((x=>!prevLinkedAssumptionIds.includes(x))),toRemovelinkedAssumptionIds=prevLinkedAssumptionIds.filter((x=>!linkedAssumptionIds.includes(x)));toAddlinkedAssumptionIds&&toAddlinkedAssumptionIds.length>0&&addAssumptionLinks(toAddlinkedAssumptionIds.map((la=>({assumptionId:la,linkedId:id,type:"Threat"})))),toRemovelinkedAssumptionIds&&toRemovelinkedAssumptionIds.length>0&&removeAssumptionLinks(toRemovelinkedAssumptionIds.map((la=>({assumptionId:la,linkedId:id,type:"Threat"}))));const toAddlinkedMitigationIds=linkedMitigationIds.filter((x=>!prevLinkedMitigationIds.includes(x))),toRemovelinkedMitigationIds=prevLinkedMitigationIds.filter((x=>!linkedMitigationIds.includes(x)));toAddlinkedMitigationIds&&toAddlinkedMitigationIds.length>0&&addMitigationLinks(toAddlinkedMitigationIds.map((lm=>({mitigationId:lm,linkedId:id})))),toRemovelinkedMitigationIds&&toRemovelinkedMitigationIds.length>0&&removeMitigationLinks(toRemovelinkedMitigationIds.map((lm=>({mitigationId:lm,linkedId:id}))))}}setEditingStatement(null),onThreatListView?.()}),[saveStatement,editingStatement,linkedAssumptionIds,linkedMitigationIds,prevLinkedAssumptionIds,prevLinkedMitigationIds,onThreatListView]),handleExampleClicked=(0,react.useCallback)((statement=>{setEditingStatement({...statement,tags:[],metadata:[],displayOrder:-1,numericId:-1,id:(0,v4.Z)()});const recommendedEditor=getRecommandedEditor(statement);recommendedEditor&&setEditor(recommendedEditor),fullExamplesRef.current?.collapse()}),[]),handleGiveExampleClicked=(0,react.useCallback)((()=>{const len=threatStatementExamples.length,randomNumber=Math.floor(Math.random()*len),statement={...threatStatementExamples[randomNumber],tags:[],metadata:[],displayOrder:-1,numericId:-1,id:(0,v4.Z)()};setEditingStatement(statement);const recommendedEditor=getRecommandedEditor(statement);recommendedEditor&&setEditor(recommendedEditor),utils_scrollToTop()}),[]),saveButtonText=(0,react.useMemo)((()=>{if(!currentWorkspace&&0===workspaceList.length)return-1===editingStatement?.numericId?"Add to list":"Save";const workspace=currentWorkspace?.name||constants.VN;return-1===editingStatement?.numericId?`Add to workspace ${workspace}`:`Save to workspace ${workspace}`}),[currentWorkspace,workspaceList,editingStatement]),handleCustomTemplateConfirm=(0,react.useCallback)((template=>{setCustomTemplateEditorVisible(!1),template!==ThreatStatementEditor_defaultThreatStatementFormat.template?setEditingStatement({...editingStatement,customTemplate:template}):setEditingStatement({...editingStatement,customTemplate:void 0})}),[editingStatement]),handleAddAssumptionLink=(0,react.useCallback)((assumptionIdOrNewAssumption=>{if(assumptionList.find((a=>a.id===assumptionIdOrNewAssumption)))setLinkedAssumptionIds((prev=>[...prev,assumptionIdOrNewAssumption]));else{const newAssumption=saveAssumption({id:constants.bU,numericId:-1,content:assumptionIdOrNewAssumption});setLinkedAssumptionIds((prev=>[...prev,newAssumption.id]))}}),[setLinkedAssumptionIds,assumptionList,saveAssumption]),handleAddMitigationLink=(0,react.useCallback)((mitigationIdOrNewMitigation=>{if(mitigationList.find((a=>a.id===mitigationIdOrNewMitigation)))setLinkedMitigationIds((prev=>[...prev,mitigationIdOrNewMitigation]));else{const newMitigation=saveMitigation({id:constants.bU,numericId:-1,content:mitigationIdOrNewMitigation});setLinkedMitigationIds((prev=>[...prev,newMitigation.id]))}}),[setLinkedMitigationIds,mitigationList,saveMitigation]),handleEditMetadata=(0,useEditMetadata.Z)(setEditingStatement);return editingStatement?(0,emotion_react_jsx_runtime_browser_esm.BX)(emotion_react_jsx_runtime_browser_esm.HY,{children:[(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"vertical",size:"l",children:["EditorOnly"!==composerMode&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_Header,{composerMode,statement:editingStatement,saveButtonText,onCancel:handleCancel,onStartOver:handleStartOver,onComplete:handleComplete}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_FinalStatement,{statement:editingStatement,displayStatement}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_FieldSelector,{composerMode,onStartOver:handleStartOver,setEditor,statement:editingStatement,currentEditor:editor,suggestions,onGiveExampleClick:handleGiveExampleClicked,setCustomTemplateEditorVisible}),Component&&editor&&(0,emotion_react_jsx_runtime_browser_esm.BX)(space_between.Z,{direction:"vertical",size:"l",children:[(0,emotion_react_jsx_runtime_browser_esm.BX)(grid.Z,{gridDefinition:[{colspan:{default:12,xs:9}},{colspan:{default:12,xs:3}}],children:[(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(Component,{ref:inputRef,statement:editingStatement,setStatement:setEditingStatement,fieldData:threatFieldData.Z[editor]})}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_Metrics,{statement:editingStatement,onClick:token=>setEditor(token)})]}),"Full"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:ThreatStatementEditor_styles.metadataContainer,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(MitigationLinkView.Z,{variant:"container",linkedMitigationIds,mitigationList,onAddMitigationLink:handleAddMitigationLink,onRemoveMitigationLink:id=>setLinkedMitigationIds((prev=>prev.filter((p=>p!==id))))})}),"Full"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:ThreatStatementEditor_styles.metadataContainer,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(AssumptionLinkView.Z,{variant:"container",linkedAssumptionIds,assumptionList,onAddAssumptionLink:handleAddAssumptionLink,onRemoveAssumptionLink:id=>setLinkedAssumptionIds((prev=>prev.filter((p=>p!==id))))})}),"Full"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.tZ)("div",{css:ThreatStatementEditor_styles.metadataContainer,children:(0,emotion_react_jsx_runtime_browser_esm.tZ)(MetadataEditor.Z,{variant:"container",editingStatement,onEditMetadata:handleEditMetadata})})]}),(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_FullExamples,{ref:fullExamplesRef,onClick:handleExampleClicked})]}),customTemplateEditorVisible&&(0,emotion_react_jsx_runtime_browser_esm.tZ)(threats_CustomTemplate,{statement:editingStatement,visible:customTemplateEditorVisible,setVisible:setCustomTemplateEditorVisible,onConfirm:handleCustomTemplateConfirm,defaultTemplate:ThreatStatementEditor_defaultThreatStatementFormat.template})]}):(0,emotion_react_jsx_runtime_browser_esm.tZ)(text_content.Z,{children:"Not threat statement editing in place"})},ThreatStatementEditor=()=>{const{editingStatement}=(0,ThreatsContext_context.a)();return editingStatement?(0,emotion_react_jsx_runtime_browser_esm.tZ)(ThreatStatementEditorInner,{editingStatement}):null},threats_ThreatStatementEditor=ThreatStatementEditor;try{ThreatStatementEditor.displayName="ThreatStatementEditor",ThreatStatementEditor.__docgenInfo={description:"",displayName:"ThreatStatementEditor",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/ThreatStatementEditor/index.tsx#ThreatStatementEditor"]={docgenInfo:ThreatStatementEditor.__docgenInfo,name:"ThreatStatementEditor",path:"src/components/threats/ThreatStatementEditor/index.tsx#ThreatStatementEditor"})}catch(__react_docgen_typescript_loader_error){}}}]);
//# sourceMappingURL=1775.cb930ab4.iframe.bundle.js.map